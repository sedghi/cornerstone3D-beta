/*! cornerstoneWADOImageLoader - v0.1.0 - 2014-04-04 | (c) 2014 Chris Hafey | https://github.com/chafey/cornerstoneWADOImageLoader */
!function(a,b){function c(a){var b=a.string("x00280030");if(b&&b.length>0){var c=b.split("\\");return{row:parseFloat(c[0]),column:parseFloat(c[1])}}return{row:void 0,column:void 0}}function d(a){var b=a.uint16("x00280103"),c=a.uint16("x00280100");return 0===b&&8===c?1:0===b&&16===c?2:1===b&&16===c?3:void 0}function e(a,b){var c=d(a),e=a.elements.x7fe00010,f=e.dataOffset;return 1===c?new Uint8Array(b.buffer,f):2===c?new Uint16Array(b.buffer,f):3===c?new Int16Array(b.buffer,f):void 0}function f(a){var b={intercept:0,slope:1},c=a.floatString("x00281052"),d=a.floatString("x00281053");return c&&(b.intercept=c),d&&(b.slope=d),b}function g(a){var b={windowCenter:void 0,windowWidth:void 0},c=a.floatString("x00281050"),d=a.floatString("x00281051");return c&&(b.windowCenter=c),d&&(b.windowWidth=d),b}function h(a){for(var b=65535,c=-32768,d=a.width*a.height,e=a.storedPixelData,f=0;d>f;f++){var g=e[f];b=Math.min(b,g),c=Math.max(c,g)}a.minPixelValue=b,a.maxPixelValue=c}function i(a){var b=new Uint8Array(a),d=dicomParser.parseDicom(b),i=c(d),j=d.uint16("x00280010"),k=d.uint16("x00280011"),l=f(d),m=g(d),n={minPixelValue:-32767,maxPixelValue:65535,slope:l.slope,intercept:l.intercept,windowCenter:m.windowCenter,windowWidth:m.windowWidth,storedPixelData:e(d,b),rows:j,columns:k,height:j,width:k,color:!1,columnPixelSpacing:i.column,rowPixelSpacing:i.row,data:d,invert:!1};h(n);var o=d.string("x00280004");if(void 0!==o&&"MONOCHROME1"===o.trim()&&(n.invert=!0),void 0===n.windowCenter){var p=n.maxPixelValue*n.slope+n.intercept,q=n.minPixelValue*n.slope+n.intercept;n.windowWidth=p-q,n.windowCenter=(p+q)/2}return n}function j(b){var c=a.Deferred(),d=new XMLHttpRequest;return d.open("get",b,!0),d.responseType="arraybuffer",d.onreadystatechange=function(){if(4===d.readyState)if(200==d.status){var a=i(d.response);c.resolve(a)}else c.reject()},d.send(),c}return b.registerImageLoader("http",j),b.registerImageLoader("https",j),b}($,cornerstone);