/*! cornerstoneWADOImageLoader - v0.1.0 - 2014-04-18 | (c) 2014 Chris Hafey | https://github.com/chafey/cornerstoneWADOImageLoader */
!function(a,b,c){function d(a){return"RGB"===a||"PALETTE COLOR"===a||"YBR_FULL"===a||"YBR_FULL_422"===a||"YBR_PARTIAL_422"===a||"YBR_PARTIAL_420"===a||"YBR_RCT"===a?!0:!1}function e(a,b){var e=new Uint8Array(a),f=dicomParser.parseDicom(e),g=f.string("x00280004"),h=d(g);return h===!1?c.makeGrayscaleImage(b,f,e,g):c.makeColorImage(b,f,e,g)}function f(b){var c=a.Deferred(),d=new XMLHttpRequest;return d.open("get",b,!0),d.responseType="arraybuffer",d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){var a=e(d.response,b);c.resolve(a)}else c.reject()},d.send(),c}document.createElement("canvas");return b.registerImageLoader("http",f),b.registerImageLoader("https",f),b}($,cornerstone,cornerstoneWADOImageLoader);var cornerstoneWADOImageLoader=function(a){"use strict";function b(a){var b=a.string("x00280030");if(b&&b.length>0){var c=b.split("\\");return{row:parseFloat(c[0]),column:parseFloat(c[1])}}return{row:void 0,column:void 0}}return void 0===a&&(a={}),a.getPixelSpacing=b,a}(cornerstoneWADOImageLoader),cornerstoneWADOImageLoader=function(a){"use strict";function b(a){var b={intercept:0,slope:1},c=a.floatString("x00281052"),d=a.floatString("x00281053");return c&&(b.intercept=c),d&&(b.slope=d),b}return void 0===a&&(a={}),a.getRescaleSlopeAndIntercept=b,a}(cornerstoneWADOImageLoader),cornerstoneWADOImageLoader=function(a){"use strict";function b(a){var b={windowCenter:void 0,windowWidth:void 0},c=a.floatString("x00281050"),d=a.floatString("x00281051");return c&&(b.windowCenter=c),d&&(b.windowWidth=d),b}return void 0===a&&(a={}),a.getWindowWidthAndCenter=b,a}(cornerstoneWADOImageLoader),cornerstoneWADOImageLoader=function(a){"use strict";function b(){}return void 0===a&&(a={}),a.makeColorImage=b,a}(cornerstoneWADOImageLoader),cornerstoneWADOImageLoader=function(a){"use strict";function b(a){{var b=a.uint16("x00280103"),c=a.uint16("x00280100");a.string("x00280004")}return 0===b&&8===c?1:0===b&&16===c?2:1===b&&16===c?3:void 0}function c(a,c){var d=b(a),e=a.elements.x7fe00010,f=e.dataOffset;return 1===d?new Uint8Array(c.buffer,f):2===d?new Uint16Array(c.buffer,f):3===d?new Int16Array(c.buffer,f):void 0}function d(a){var c=b(a);if(1===c)return 1;if(2===c||3===c)return 2;throw"unknown pixel format"}function e(a){for(var b=65535,c=-32768,d=a.width*a.height,e=a.storedPixelData,f=0;d>f;f++){var g=e[f];b=Math.min(b,g),c=Math.max(c,g)}return{min:b,max:c}}function f(b,f,g,h){function i(){return r}var j=a.getPixelSpacing(f),k=f.uint16("x00280010"),l=f.uint16("x00280011"),m=a.getRescaleSlopeAndIntercept(f),n=d(f),o=k*l*n,p="MONOCHROME1"===h,q=a.getWindowWidthAndCenter(f),r=c(f,g),s=e(r),t={imageId:b,minPixelValue:s.min,maxPixelValue:s.max,slope:m.slope,intercept:m.intercept,windowCenter:q.windowCenter,windowWidth:q.windowWidth,getPixelData:i,rows:k,columns:l,height:k,width:l,color:!1,columnPixelSpacing:j.column,rowPixelSpacing:j.row,data:f,invert:p,sizeInBytes:o};if(void 0===t.windowCenter){var u=t.maxPixelValue*t.slope+t.intercept,v=t.minPixelValue*t.slope+t.intercept;t.windowWidth=u-v,t.windowCenter=(u+v)/2}return t}return void 0===a&&(a={}),a.makeGrayscaleImage=f,a}(cornerstoneWADOImageLoader);