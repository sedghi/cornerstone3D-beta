{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///cornerstoneWADOImageLoader.min.js","webpack:///webpack/bootstrap 19c1f85d7669329a8d0d","webpack:///./externalModules.js","webpack:///./imageLoader/internal/index.js","webpack:///./shared/getMinMax.js","webpack:///./imageLoader/wadors/metaData/getValue.js","webpack:///./imageLoader/wadouri/parseImageId.js","webpack:///./imageLoader/wadors/metaDataManager.js","webpack:///./imageLoader/internal/options.js","webpack:///./imageLoader/createImage.js","webpack:///./imageLoader/wadouri/dataSetCacheManager.js","webpack:///./version.js","webpack:///./imageLoader/colorSpaceConverters/index.js","webpack:///./imageLoader/wadouri/index.js","webpack:///./imageLoader/wadouri/metaData/index.js","webpack:///./imageLoader/wadouri/metaData/getImagePixelModule.js","webpack:///./imageLoader/wadouri/metaData/getLUTs.js","webpack:///./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js","webpack:///./imageLoader/wadouri/metaData/getNumberValues.js","webpack:///./imageLoader/wadors/index.js","webpack:///./imageLoader/wadors/metaData/index.js","webpack:///./imageLoader/wadors/metaData/getNumberValue.js","webpack:///./imageLoader/wadors/metaData/getNumberValues.js","webpack:///./imageLoader/wadors/findIndexOfString.js","webpack:///./imageLoader/wadors/getPixelData.js","webpack:///./imageLoader/wadors/loadImage.js","webpack:///./imageLoader/getImageFrame.js","webpack:///./imageLoader/decodeImageFrame.js","webpack:///./imageLoader/webWorkerManager.js","webpack:///./imageLoader/decodeJPEGBaseline8BitColor.js","webpack:///./imageLoader/isColorImage.js","webpack:///./imageLoader/convertColorSpace.js","webpack:///./imageLoader/isJPEGBaseline8BitColor.js","webpack:///./imageLoader/wadouri/fileManager.js","webpack:///./imageLoader/wadouri/getEncapsulatedImageFrame.js","webpack:///./imageLoader/wadouri/getUncompressedImageFrame.js","webpack:///./imageLoader/wadouri/unpackBinaryFrame.js","webpack:///./imageLoader/wadouri/loadFileRequest.js","webpack:///./imageLoader/wadouri/loadImage.js","webpack:///./imageLoader/index.js","webpack:///./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js","webpack:///./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js","webpack:///./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js","webpack:///./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js","webpack:///./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js","webpack:///./imageLoader/wadouri/metaData/metaDataProvider.js","webpack:///external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}","webpack:///external {\"commonjs\":\"dicom-parser\",\"commonjs2\":\"dicom-parser\",\"amd\":\"dicom-parser\",\"root\":\"dicomParser\"}","webpack:///./imageLoader/registerLoaders.js","webpack:///./imageLoader/wadors/metaData/getNumberString.js","webpack:///./imageLoader/wadors/metaData/metaDataProvider.js","webpack:///./imageLoader/internal/xhrRequest.js","webpack:///./imageLoader/wadors/register.js","webpack:///./imageLoader/wadouri/getPixelData.js","webpack:///./imageLoader/wadouri/register.js","webpack:///./imageLoader/configure.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_46__","__WEBPACK_EXTERNAL_MODULE_47__","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","value","external","dicomParser","$","undefined","_jquery","_jquery2","_dicomParser","newObj","key","_registerLoaders","_registerLoaders2","cornerstone","cs","internal","xhrRequest","getOptions","setOptions","_xhrRequest","_xhrRequest2","_options","getMinMax","storedPixelData","min","max","storedPixel","numPixels","length","index","Math","getValue","element","defaultValue","Value","parseImageId","imageId","firstColonIndex","indexOf","url","substring","frameIndex","frame","frameStr","substr","parseInt","scheme","add","metadata","imageIds","remove","purge","newOptions","options","beforeSend","imageCreated","strict","isModalityLUTForDisplay","sopClassUid","setPixelDataType","imageFrame","bitsAllocated","pixelRepresentation","pixelData","Uint16Array","Int16Array","Uint8Array","createImage","transferSyntax","_externalModules","canvas","document","createElement","_getImageFrame2","decodePromise","_decodeImageFrame2","Promise","resolve","reject","then","imagePlaneModule","metaData","voiLutModule","modalityLutModule","sopCommonModule","isColorImage","_isColorImage2","photometricInterpretation","_isJPEGBaseline8BitColor2","height","rows","width","columns","context","getContext","imageData","createImageData","_convertColorSpace2","data","minMax","_getMinMax2","smallestPixelValue","largestPixelValue","image","color","columnPixelSpacing","pixelSpacing","intercept","rescaleIntercept","invert","minPixelValue","maxPixelValue","render","rowPixelSpacing","sizeInBytes","slope","rescaleSlope","windowCenter","windowWidth","decodeTimeInMS","getPixelData","renderColorImage","getCanvas","lastImageIdDrawn","putImageData","renderGrayscaleImage","modalityLUTSequence","sopClassUID","modalityLUT","voiLUTSequence","voiLUT","maxVoi","minVoi","_getImageFrame","_decodeImageFrame","_isColorImage","_convertColorSpace","_getMinMax","_isJPEGBaseline8BitColor","isLoaded","uri","loadedDataSets","dataSet","load","loadRequest","arguments","_index","cacheCount","promises","loadDICOMPromise","promise","dicomPart10AsArrayBuffer","byteArray","parseDicom","error","unload","_convertRGBColorByPixel","_convertRGBColorByPlane","_convertYBRFullByPixel","_convertYBRFullByPlane","_convertPALETTECOLOR","_dataSetCacheManager","_dataSetCacheManager2","_fileManager","_fileManager2","_getEncapsulatedImageFrame","_getEncapsulatedImageFrame2","_getUncompressedImageFrame","_getUncompressedImageFrame2","_loadFileRequest","_loadFileRequest2","_loadImage","_parseImageId","_parseImageId2","_unpackBinaryFrame","_unpackBinaryFrame2","_register","_register2","getImagePixelModule","getLUTs","getModalityLUTOutputPixelRepresentation","getNumberValues","metaDataProvider","dataSetCacheManager","fileManager","getEncapsulatedImageFrame","getUncompressedImageFrame","loadFileRequest","loadImageFromPromise","getLoaderForScheme","loadImage","unpackBinaryFrame","register","_getImagePixelModule","_getLUTs","_getModalityLUTOutputPixelRepresentation","_getNumberValues","_metaDataProvider","getLutDescriptor","tag","elements","uint16","getLutData","lutDataSet","lutDescriptor","lut","lutData","numLutEntries","dataOffset","populatePaletteColorLut","imagePixelModule","x00281101","redPaletteColorLookupTableDescriptor","greenPaletteColorLookupTableDescriptor","bluePaletteColorLookupTableDescriptor","redPaletteColorLookupTableData","greenPaletteColorLookupTableData","bluePaletteColorLookupTableData","populateSmallestLargestPixelValues","int16","samplesPerPixel","string","bitsStored","highBit","planarConfiguration","pixelAspectRatio","getLUT","numLUTEntries","firstValueMapped","numBitsPerEntry","id","lutSequence","items","luts","push","getMinStoredPixelValue","floatString","x00283000","minimumLength","values","valueAsString","split","parseFloat","_findIndexOfString","_findIndexOfString2","_getPixelData","_getPixelData2","_metaDataManager","_metaDataManager2","_loadImage2","getNumberString","getNumberValue","findIndexOfString","metaDataManager","_getNumberString","_getNumberValue","_getValue","_getValue2","checkToken","token","endIndex","stringToUint8Array","str","uint","j","charCodeAt","offset","findBoundary","header","findContentType","trim","uint8ArrayToString","String","fromCharCode","mediaType","headers","accept","imageFrameAsArrayBuffer","response","tokenIndex","Error","boundary","contentType","getTransferSyntaxForContentType","start","Date","getTime","deferred","Deferred","result","_createImage2","end","loadTimeInMS","reason","_createImage","getImageFrame","addDecodeTask","priority","transferList","transferPixelData","buffer","_webWorkerManager2","addTask","decodeImageFrame","_decodeJPEGBaseline8BitColor2","_webWorkerManager","_decodeJPEGBaseline8BitColor","startTaskOnWebWorker","tasks","webWorkers","status","task","shift","statistics","totalTimeDelayedInMS","added","worker","postMessage","taskType","workerIndex","numTasksExecuting","config","maxWebWorkers","spawnWebWorker","handleMessageFromWorker","msg","numTasksCompleted","totalTaskTimeInMS","Worker","webWorkerPath","addEventListener","initialize","configObject","defaultConfig","navigator","hardwareConcurrency","startWebWorkersOnDemand","loadWebWorkerTask","sourcePath","taskConfig","webWorkerTaskPaths","taskConfiguration","assign","taskId","nextTaskId","splice","setTaskPriority","cancelTask","getStatistics","numWebWorkers","numTasksQueued","decodeTask","loadCodecsOnStartup","initializeCodecsOnStartup","codecsPath","usePDFJS","arrayBufferToString","binaryToString","apply","Array","slice","binary","decodeURIComponent","escape","_error","URIError","decodeJPEGBaseline8BitColor","imgBlob","Blob","type","fileReader","FileReader","readAsBinaryString","readAsArrayBuffer","onload","img","Image","drawImage","getImageData","onerror","src","window","btoa","e","photoMetricInterpretation","convertRGB","rgbaBuffer","convertRGBColorByPixel","convertRGBColorByPlane","convertYBRFull","convertYBRFullByPixel","convertYBRFullByPlane","convertColorSpace","convertPALETTECOLOR","isJPEGBaseline8BitColor","file","files","framesAreFragmented","intString","x7fe00010","fragments","basicOffsetTable","readEncapsulatedImageFrame","createJPEGBasicOffsetTable","readEncapsulatedPixelDataFromFragments","pixelDataElement","pixelDataOffset","pixelsPerFrame","frameOffset","isBitSet","byte","bitPos","bytePos","floor","parsedImageId","fileIndex","target","addDecache","decache","dataSetPromise","sharedCacheKey","loadEnd","totalTimeInMS","loadImageFromDataSet","loader","keys","forEach","_index2","_index3","_configure","_version","_index4","rgbIndex","rgbaIndex","rIndex","gIndex","bIndex","ybrIndex","y","cb","cr","yIndex","cbIndex","crIndex","palIndex","rData","gData","bData","len","modality","seriesInstanceUID","seriesNumber","studyInstanceUID","seriesDate","parseDA","seriesTime","parseTM","patientAge","patientSize","patientWeight","_getNumberValues2","imageOrientationPatient","imagePositionPatient","sliceThickness","sliceLocation","frameOfReferenceUID","_getImagePixelModule2","rescaleType","_getLUTs2","modalityLUTOutputPixelRepresentation","_getModalityLUTOutputPixelRepresentation2","x00283010","sopInstanceUID","radiopharmaceuticalInfo","x00540016","firstRadiopharmaceuticalInfoDataSet","radiopharmaceuticalStartTime","radionuclideTotalDose","radionuclideHalfLife","registerLoaders","_getNumberValue2","params","xhr","XMLHttpRequest","open","responseType","setRequestHeader","onloadstart","event","eventData","events","trigger","customEvent","CustomEvent","detail","dispatchEvent","onloadend","onreadystatechange","readyState","onprogress","oProgress","loaded","total","percentComplete","lengthComputable","round","send","registerImageLoader","addProvider","encapsulatedPixelData","configure"],"mappings":"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","file":"cornerstoneWADOImageLoader.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"dicom-parser\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"cornerstoneWADOImageLoader\", [\"jquery\", \"dicom-parser\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cornerstoneWADOImageLoader\"] = factory(require(\"jquery\"), require(\"dicom-parser\"));\n\telse\n\t\troot[\"cornerstoneWADOImageLoader\"] = factory(root[\"$\"], root[\"dicomParser\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_46__, __WEBPACK_EXTERNAL_MODULE_47__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","/*! cornerstone-wado-image-loader - 1.0.1 - 2017-11-06 | (c) 2016 Chris Hafey | https://github.com/chafey/cornerstoneWADOImageLoader */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"dicom-parser\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"cornerstoneWADOImageLoader\", [\"jquery\", \"dicom-parser\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cornerstoneWADOImageLoader\"] = factory(require(\"jquery\"), require(\"dicom-parser\"));\n\telse\n\t\troot[\"cornerstoneWADOImageLoader\"] = factory(root[\"$\"], root[\"dicomParser\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_46__, __WEBPACK_EXTERNAL_MODULE_47__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 39);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.external = exports.dicomParser = exports.$ = undefined;\n\nvar _jquery = __webpack_require__(46);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _dicomParser = __webpack_require__(47);\n\nvar dicomParser = _interopRequireWildcard(_dicomParser);\n\nvar _registerLoaders = __webpack_require__(48);\n\nvar _registerLoaders2 = _interopRequireDefault(_registerLoaders);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar cornerstone = void 0;\n\nvar external = {\n  set cornerstone(cs) {\n    cornerstone = cs;\n\n    (0, _registerLoaders2.default)(cornerstone);\n  },\n  get cornerstone() {\n    return cornerstone;\n  }\n};\n\nexports.$ = _jquery2.default;\nexports.dicomParser = dicomParser;\nexports.external = external;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.internal = exports.xhrRequest = exports.getOptions = exports.setOptions = undefined;\n\nvar _xhrRequest = __webpack_require__(51);\n\nvar _xhrRequest2 = _interopRequireDefault(_xhrRequest);\n\nvar _options = __webpack_require__(6);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar internal = {\n  xhrRequest: _xhrRequest2.default,\n  setOptions: _options.setOptions,\n  getOptions: _options.getOptions\n};\n\nexports.setOptions = _options.setOptions;\nexports.getOptions = _options.getOptions;\nexports.xhrRequest = _xhrRequest2.default;\nexports.internal = internal;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nfunction getMinMax(storedPixelData) {\n  // we always calculate the min max values since they are not always\n  // present in DICOM and we don't want to trust them anyway as cornerstone\n  // depends on us providing reliable values for these\n  var min = storedPixelData[0];\n  var max = storedPixelData[0];\n  var storedPixel = void 0;\n  var numPixels = storedPixelData.length;\n\n  for (var index = 1; index < numPixels; index++) {\n    storedPixel = storedPixelData[index];\n    min = Math.min(min, storedPixel);\n    max = Math.max(max, storedPixel);\n  }\n\n  return {\n    min: min,\n    max: max\n  };\n}\n\nexports.default = getMinMax;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n\n/**\n * Returns the raw value\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param [index] - the index of the value in a multi-valued element, default is 0\n * @param [defaultValue] - The default value to return if the element does not exist\n * @returns {*}\n */\nfunction getValue(element, index, defaultValue) {\n  index = index || 0;\n  if (!element) {\n    return defaultValue;\n  }\n  // Value is not present if the attribute has a zero length value\n  if (!element.Value) {\n    return defaultValue;\n  }\n  // make sure we have the specified index\n  if (element.Value.length <= index) {\n    return defaultValue;\n  }\n\n  return element.Value[index];\n}\n\nexports.default = getValue;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nfunction parseImageId(imageId) {\n  // build a url by parsing out the url scheme and frame index from the imageId\n  var firstColonIndex = imageId.indexOf(':');\n  var url = imageId.substring(firstColonIndex + 1);\n  var frameIndex = url.indexOf('frame=');\n  var frame = void 0;\n\n  if (frameIndex !== -1) {\n    var frameStr = url.substr(frameIndex + 6);\n\n    frame = parseInt(frameStr, 10);\n    url = url.substr(0, frameIndex - 1);\n  }\n\n  return {\n    scheme: imageId.substr(0, firstColonIndex),\n    url: url,\n    frame: frame\n  };\n}\n\nexports.default = parseImageId;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n\nvar imageIds = [];\n\nfunction add(imageId, metadata) {\n  imageIds[imageId] = metadata;\n}\n\nfunction get(imageId) {\n  return imageIds[imageId];\n}\n\nfunction remove(imageId) {\n  imageIds[imageId] = undefined;\n}\n\nfunction purge() {\n  imageIds = [];\n}\n\nexports.default = {\n  add: add,\n  get: get,\n  remove: remove,\n  purge: purge\n};\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setOptions = setOptions;\nexports.getOptions = getOptions;\nvar options = {\n  // callback allowing customization of the xhr (e.g. adding custom auth headers, cors, etc)\n  beforeSend: function beforeSend() /* xhr */{},\n\n  // callback allowing modification of newly created image objects\n  imageCreated: function imageCreated() /* image */{},\n\n  strict: false\n};\n\nfunction setOptions(newOptions) {\n  options = newOptions;\n}\n\nfunction getOptions() {\n  return options;\n}\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _externalModules = __webpack_require__(0);\n\nvar _getImageFrame = __webpack_require__(24);\n\nvar _getImageFrame2 = _interopRequireDefault(_getImageFrame);\n\nvar _decodeImageFrame = __webpack_require__(25);\n\nvar _decodeImageFrame2 = _interopRequireDefault(_decodeImageFrame);\n\nvar _isColorImage = __webpack_require__(28);\n\nvar _isColorImage2 = _interopRequireDefault(_isColorImage);\n\nvar _convertColorSpace = __webpack_require__(29);\n\nvar _convertColorSpace2 = _interopRequireDefault(_convertColorSpace);\n\nvar _getMinMax = __webpack_require__(2);\n\nvar _getMinMax2 = _interopRequireDefault(_getMinMax);\n\nvar _isJPEGBaseline8BitColor = __webpack_require__(30);\n\nvar _isJPEGBaseline8BitColor2 = _interopRequireDefault(_isJPEGBaseline8BitColor);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar lastImageIdDrawn = '';\n\nfunction isModalityLUTForDisplay(sopClassUid) {\n  // special case for XA and XRF\n  // https://groups.google.com/forum/#!searchin/comp.protocols.dicom/Modality$20LUT$20XA/comp.protocols.dicom/UBxhOZ2anJ0/D0R_QP8V2wIJ\n  return sopClassUid !== '1.2.840.10008.5.1.4.1.1.12.1' && // XA\n  sopClassUid !== '1.2.840.10008.5.1.4.1.1.12.2.1'; // XRF\n}\n\n/**\n * Helper function to set pixel data to the right typed array.  This is needed because web workers\n * can transfer array buffers but not typed arrays\n * @param imageFrame\n */\nfunction setPixelDataType(imageFrame) {\n  if (imageFrame.bitsAllocated === 16) {\n    if (imageFrame.pixelRepresentation === 0) {\n      imageFrame.pixelData = new Uint16Array(imageFrame.pixelData);\n    } else {\n      imageFrame.pixelData = new Int16Array(imageFrame.pixelData);\n    }\n  } else {\n    imageFrame.pixelData = new Uint8Array(imageFrame.pixelData);\n  }\n}\n\nfunction createImage(imageId, pixelData, transferSyntax, options) {\n  var cornerstone = _externalModules.external.cornerstone;\n  var canvas = document.createElement('canvas');\n  var imageFrame = (0, _getImageFrame2.default)(imageId);\n  var decodePromise = (0, _decodeImageFrame2.default)(imageFrame, transferSyntax, pixelData, canvas, options);\n\n  return new Promise(function (resolve, reject) {\n    decodePromise.then(function (imageFrame) {\n      var imagePlaneModule = cornerstone.metaData.get('imagePlaneModule', imageId) || {};\n      var voiLutModule = cornerstone.metaData.get('voiLutModule', imageId) || {};\n      var modalityLutModule = cornerstone.metaData.get('modalityLutModule', imageId) || {};\n      var sopCommonModule = cornerstone.metaData.get('sopCommonModule', imageId) || {};\n      var isColorImage = (0, _isColorImage2.default)(imageFrame.photometricInterpretation);\n\n      // JPEGBaseline (8 bits) is already returning the pixel data in the right format (rgba)\n      // because it's using a canvas to load and decode images.\n      if (!(0, _isJPEGBaseline8BitColor2.default)(imageFrame, transferSyntax)) {\n        setPixelDataType(imageFrame);\n\n        // convert color space\n        if (isColorImage) {\n          // setup the canvas context\n          canvas.height = imageFrame.rows;\n          canvas.width = imageFrame.columns;\n\n          var context = canvas.getContext('2d');\n          var imageData = context.createImageData(imageFrame.columns, imageFrame.rows);\n\n          (0, _convertColorSpace2.default)(imageFrame, imageData);\n          imageFrame.imageData = imageData;\n          imageFrame.pixelData = imageData.data;\n\n          // calculate smallest and largest PixelValue of the converted pixelData\n          var minMax = (0, _getMinMax2.default)(imageFrame.pixelData);\n\n          imageFrame.smallestPixelValue = minMax.min;\n          imageFrame.largestPixelValue = minMax.max;\n        }\n      }\n\n      var image = {\n        imageId: imageId,\n        color: isColorImage,\n        columnPixelSpacing: imagePlaneModule.pixelSpacing ? imagePlaneModule.pixelSpacing[1] : undefined,\n        columns: imageFrame.columns,\n        height: imageFrame.rows,\n        intercept: modalityLutModule.rescaleIntercept ? modalityLutModule.rescaleIntercept : 0,\n        invert: imageFrame.photometricInterpretation === 'MONOCHROME1',\n        minPixelValue: imageFrame.smallestPixelValue,\n        maxPixelValue: imageFrame.largestPixelValue,\n        render: undefined, // set below\n        rowPixelSpacing: imagePlaneModule.pixelSpacing ? imagePlaneModule.pixelSpacing[0] : undefined,\n        rows: imageFrame.rows,\n        sizeInBytes: imageFrame.pixelData.length,\n        slope: modalityLutModule.rescaleSlope ? modalityLutModule.rescaleSlope : 1,\n        width: imageFrame.columns,\n        windowCenter: voiLutModule.windowCenter ? voiLutModule.windowCenter[0] : undefined,\n        windowWidth: voiLutModule.windowWidth ? voiLutModule.windowWidth[0] : undefined,\n        decodeTimeInMS: imageFrame.decodeTimeInMS\n      };\n\n      // add function to return pixel data\n      image.getPixelData = function () {\n        return imageFrame.pixelData;\n      };\n\n      // Setup the renderer\n      if (image.color) {\n        image.render = cornerstone.renderColorImage;\n        image.getCanvas = function () {\n          if (lastImageIdDrawn === imageId) {\n            return canvas;\n          }\n\n          canvas.height = image.rows;\n          canvas.width = image.columns;\n          var context = canvas.getContext('2d');\n\n          context.putImageData(imageFrame.imageData, 0, 0);\n          lastImageIdDrawn = imageId;\n\n          return canvas;\n        };\n      } else {\n        image.render = cornerstone.renderGrayscaleImage;\n      }\n\n      // Modality LUT\n      if (modalityLutModule.modalityLUTSequence && modalityLutModule.modalityLUTSequence.length > 0 && isModalityLUTForDisplay(sopCommonModule.sopClassUID)) {\n        image.modalityLUT = modalityLutModule.modalityLUTSequence[0];\n      }\n\n      // VOI LUT\n      if (voiLutModule.voiLUTSequence && voiLutModule.voiLUTSequence.length > 0) {\n        image.voiLUT = voiLutModule.voiLUTSequence[0];\n      }\n\n      // set the ww/wc to cover the dynamic range of the image if no values are supplied\n      if (image.windowCenter === undefined || image.windowWidth === undefined) {\n        if (image.color) {\n          image.windowWidth = 255;\n          image.windowCenter = 128;\n        } else {\n          var maxVoi = image.maxPixelValue * image.slope + image.intercept;\n          var minVoi = image.minPixelValue * image.slope + image.intercept;\n\n          image.windowWidth = maxVoi - minVoi;\n          image.windowCenter = (maxVoi + minVoi) / 2;\n        }\n      }\n      resolve(image);\n    }, reject);\n  });\n}\n\nexports.default = createImage;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _externalModules = __webpack_require__(0);\n\nvar _index = __webpack_require__(1);\n\n/**\n * This object supports loading of DICOM P10 dataset from a uri and caching it so it can be accessed\n * by the caller.  This allows a caller to access the datasets without having to go through cornerstone's\n * image loader mechanism.  One reason a caller may need to do this is to determine the number of frames\n * in a multiframe sop instance so it can create the imageId's correctly.\n */\nvar loadedDataSets = {};\nvar promises = {};\n\n// returns true if the wadouri for the specified index has been loaded\nfunction isLoaded(uri) {\n  return loadedDataSets[uri] !== undefined;\n}\n\nfunction get(uri) {\n  if (!loadedDataSets[uri]) {\n    return;\n  }\n\n  return loadedDataSets[uri].dataSet;\n}\n\n// loads the dicom dataset from the wadouri sp\nfunction load(uri) {\n  var loadRequest = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _index.xhrRequest;\n  var imageId = arguments[2];\n\n  // if already loaded return it right away\n  if (loadedDataSets[uri]) {\n    // console.log('using loaded dataset ' + uri);\n    return new Promise(function (resolve) {\n      loadedDataSets[uri].cacheCount++;\n      resolve(loadedDataSets[uri].dataSet);\n    });\n  }\n\n  // if we are currently loading this uri, return its promise\n  if (promises[uri]) {\n    // console.log('returning existing load promise for ' + uri);\n    return promises[uri];\n  }\n\n  // This uri is not loaded or being loaded, load it via an xhrRequest\n  var loadDICOMPromise = loadRequest(uri, imageId);\n\n  // handle success and failure of the XHR request load\n  var promise = new Promise(function (resolve, reject) {\n    loadDICOMPromise.then(function (dicomPart10AsArrayBuffer /* , xhr*/) {\n      var byteArray = new Uint8Array(dicomPart10AsArrayBuffer);\n\n      // Reject the promise if parsing the dicom file fails\n      var dataSet = void 0;\n\n      try {\n        dataSet = _externalModules.dicomParser.parseDicom(byteArray);\n      } catch (error) {\n        return reject(error);\n      }\n\n      loadedDataSets[uri] = {\n        dataSet: dataSet,\n        cacheCount: 1\n      };\n\n      resolve(dataSet);\n    }, reject).then(function () {\n      // Remove the promise regardless of success or failure\n      delete promises[uri];\n    });\n  });\n\n  promises[uri] = promise;\n\n  return promise;\n}\n\n// remove the cached/loaded dicom dataset for the specified wadouri to free up memory\nfunction unload(uri) {\n  // console.log('unload for ' + uri);\n  if (loadedDataSets[uri]) {\n    loadedDataSets[uri].cacheCount--;\n    if (loadedDataSets[uri].cacheCount === 0) {\n      // console.log('removing loaded dataset for ' + uri);\n      delete loadedDataSets[uri];\n    }\n  }\n}\n\n// removes all cached datasets from memory\nfunction purge() {\n  loadedDataSets = {};\n  promises = {};\n}\n\nexports.default = {\n  isLoaded: isLoaded,\n  load: load,\n  unload: unload,\n  purge: purge,\n  get: get\n};\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = '1.0.1';\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _convertRGBColorByPixel = __webpack_require__(40);\n\nObject.defineProperty(exports, 'convertRGBColorByPixel', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_convertRGBColorByPixel).default;\n  }\n});\n\nvar _convertRGBColorByPlane = __webpack_require__(41);\n\nObject.defineProperty(exports, 'convertRGBColorByPlane', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_convertRGBColorByPlane).default;\n  }\n});\n\nvar _convertYBRFullByPixel = __webpack_require__(42);\n\nObject.defineProperty(exports, 'convertYBRFullByPixel', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_convertYBRFullByPixel).default;\n  }\n});\n\nvar _convertYBRFullByPlane = __webpack_require__(43);\n\nObject.defineProperty(exports, 'convertYBRFullByPlane', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_convertYBRFullByPlane).default;\n  }\n});\n\nvar _convertPALETTECOLOR = __webpack_require__(44);\n\nObject.defineProperty(exports, 'convertPALETTECOLOR', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_convertPALETTECOLOR).default;\n  }\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _index = __webpack_require__(12);\n\nvar _dataSetCacheManager = __webpack_require__(8);\n\nvar _dataSetCacheManager2 = _interopRequireDefault(_dataSetCacheManager);\n\nvar _fileManager = __webpack_require__(31);\n\nvar _fileManager2 = _interopRequireDefault(_fileManager);\n\nvar _getEncapsulatedImageFrame = __webpack_require__(32);\n\nvar _getEncapsulatedImageFrame2 = _interopRequireDefault(_getEncapsulatedImageFrame);\n\nvar _getUncompressedImageFrame = __webpack_require__(33);\n\nvar _getUncompressedImageFrame2 = _interopRequireDefault(_getUncompressedImageFrame);\n\nvar _loadFileRequest = __webpack_require__(35);\n\nvar _loadFileRequest2 = _interopRequireDefault(_loadFileRequest);\n\nvar _loadImage = __webpack_require__(36);\n\nvar _parseImageId = __webpack_require__(4);\n\nvar _parseImageId2 = _interopRequireDefault(_parseImageId);\n\nvar _unpackBinaryFrame = __webpack_require__(34);\n\nvar _unpackBinaryFrame2 = _interopRequireDefault(_unpackBinaryFrame);\n\nvar _register = __webpack_require__(54);\n\nvar _register2 = _interopRequireDefault(_register);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar metaData = {\n  getImagePixelModule: _index.getImagePixelModule,\n  getLUTs: _index.getLUTs,\n  getModalityLUTOutputPixelRepresentation: _index.getModalityLUTOutputPixelRepresentation,\n  getNumberValues: _index.getNumberValues,\n  metaDataProvider: _index.metaDataProvider\n};\n\nexports.default = {\n  metaData: metaData,\n  dataSetCacheManager: _dataSetCacheManager2.default,\n  fileManager: _fileManager2.default,\n  getEncapsulatedImageFrame: _getEncapsulatedImageFrame2.default,\n  getUncompressedImageFrame: _getUncompressedImageFrame2.default,\n  loadFileRequest: _loadFileRequest2.default,\n  loadImageFromPromise: _loadImage.loadImageFromPromise,\n  getLoaderForScheme: _loadImage.getLoaderForScheme,\n  loadImage: _loadImage.loadImage,\n  parseImageId: _parseImageId2.default,\n  unpackBinaryFrame: _unpackBinaryFrame2.default,\n  register: _register2.default\n};\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getImagePixelModule = __webpack_require__(13);\n\nObject.defineProperty(exports, 'getImagePixelModule', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getImagePixelModule).default;\n  }\n});\n\nvar _getLUTs = __webpack_require__(14);\n\nObject.defineProperty(exports, 'getLUTs', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getLUTs).default;\n  }\n});\n\nvar _getModalityLUTOutputPixelRepresentation = __webpack_require__(15);\n\nObject.defineProperty(exports, 'getModalityLUTOutputPixelRepresentation', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getModalityLUTOutputPixelRepresentation).default;\n  }\n});\n\nvar _getNumberValues = __webpack_require__(16);\n\nObject.defineProperty(exports, 'getNumberValues', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getNumberValues).default;\n  }\n});\n\nvar _metaDataProvider = __webpack_require__(45);\n\nObject.defineProperty(exports, 'metaDataProvider', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_metaDataProvider).default;\n  }\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nfunction getLutDescriptor(dataSet, tag) {\n  if (!dataSet.elements[tag] || dataSet.elements[tag].length !== 6) {\n    return;\n  }\n\n  return [dataSet.uint16(tag, 0), dataSet.uint16(tag, 1), dataSet.uint16(tag, 2)];\n}\n\nfunction getLutData(lutDataSet, tag, lutDescriptor) {\n  var lut = [];\n  var lutData = lutDataSet.elements[tag];\n\n  // The first Palette Color Lookup Table Descriptor value is the number of entries in the lookup table.\n  // When the number of table entries is equal to 2ˆ16 then this value shall be 0.\n  // See http://dicom.nema.org/MEDICAL/DICOM/current/output/chtml/part03/sect_C.7.6.3.html#sect_C.7.6.3.1.5\n  var numLutEntries = lutDescriptor[0] || 65536;\n\n  for (var i = 0; i < numLutEntries; i++) {\n    // Output range is always unsigned\n    if (lutDescriptor[2] === 16) {\n      lut[i] = lutDataSet.uint16(tag, i);\n    } else {\n      lut[i] = lutDataSet.byteArray[i + lutData.dataOffset];\n    }\n  }\n\n  return lut;\n}\n\nfunction populatePaletteColorLut(dataSet, imagePixelModule) {\n  // return immediately if photometric interpretation is not PALETTE COLOR or no palette lut elements\n  if (imagePixelModule.photometricInterpretation !== 'PALETTE COLOR' || !dataSet.elements.x00281101) {\n    return;\n  }\n  imagePixelModule.redPaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281101');\n  imagePixelModule.greenPaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281102');\n  imagePixelModule.bluePaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281103');\n\n  imagePixelModule.redPaletteColorLookupTableData = getLutData(dataSet, 'x00281201', imagePixelModule.redPaletteColorLookupTableDescriptor);\n  imagePixelModule.greenPaletteColorLookupTableData = getLutData(dataSet, 'x00281202', imagePixelModule.greenPaletteColorLookupTableDescriptor);\n  imagePixelModule.bluePaletteColorLookupTableData = getLutData(dataSet, 'x00281203', imagePixelModule.bluePaletteColorLookupTableDescriptor);\n}\n\nfunction populateSmallestLargestPixelValues(dataSet, imagePixelModule) {\n  var pixelRepresentation = dataSet.uint16('x00280103');\n\n  if (pixelRepresentation === 0) {\n    imagePixelModule.smallestPixelValue = dataSet.uint16('x00280106');\n    imagePixelModule.largestPixelValue = dataSet.uint16('x00280107');\n  } else {\n    imagePixelModule.smallestPixelValue = dataSet.int16('x00280106');\n    imagePixelModule.largestPixelValue = dataSet.int16('x00280107');\n  }\n}\n\nfunction getImagePixelModule(dataSet) {\n  var imagePixelModule = {\n    samplesPerPixel: dataSet.uint16('x00280002'),\n    photometricInterpretation: dataSet.string('x00280004'),\n    rows: dataSet.uint16('x00280010'),\n    columns: dataSet.uint16('x00280011'),\n    bitsAllocated: dataSet.uint16('x00280100'),\n    bitsStored: dataSet.uint16('x00280101'),\n    highBit: dataSet.uint16('x00280102'),\n    pixelRepresentation: dataSet.uint16('x00280103'),\n    planarConfiguration: dataSet.uint16('x00280006'),\n    pixelAspectRatio: dataSet.string('x00280034')\n  };\n\n  populateSmallestLargestPixelValues(dataSet, imagePixelModule);\n  populatePaletteColorLut(dataSet, imagePixelModule);\n\n  return imagePixelModule;\n}\n\nexports.default = getImagePixelModule;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nfunction getLUT(pixelRepresentation, lutDataSet) {\n  var numLUTEntries = lutDataSet.uint16('x00283002', 0);\n\n  if (numLUTEntries === 0) {\n    numLUTEntries = 65535;\n  }\n  var firstValueMapped = 0;\n\n  if (pixelRepresentation === 0) {\n    firstValueMapped = lutDataSet.uint16('x00283002', 1);\n  } else {\n    firstValueMapped = lutDataSet.int16('x00283002', 1);\n  }\n  var numBitsPerEntry = lutDataSet.uint16('x00283002', 2);\n  // console.log('LUT(', numLUTEntries, ',', firstValueMapped, ',', numBitsPerEntry, ')');\n  var lut = {\n    id: '1',\n    firstValueMapped: firstValueMapped,\n    numBitsPerEntry: numBitsPerEntry,\n    lut: []\n  };\n\n  // console.log(\"minValue=\", minValue, \"; maxValue=\", maxValue);\n  for (var i = 0; i < numLUTEntries; i++) {\n    if (pixelRepresentation === 0) {\n      lut.lut[i] = lutDataSet.uint16('x00283006', i);\n    } else {\n      lut.lut[i] = lutDataSet.int16('x00283006', i);\n    }\n  }\n\n  return lut;\n}\n\nfunction getLUTs(pixelRepresentation, lutSequence) {\n  if (!lutSequence || !lutSequence.items.length) {\n    return;\n  }\n  var luts = [];\n\n  for (var i = 0; i < lutSequence.items.length; i++) {\n    var lutDataSet = lutSequence.items[i].dataSet;\n    var lut = getLUT(pixelRepresentation, lutDataSet);\n\n    if (lut) {\n      luts.push(lut);\n    }\n  }\n\n  return luts;\n}\n\nexports.default = getLUTs;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/* eslint no-bitwise: 0 */\n\nfunction getMinStoredPixelValue(dataSet) {\n  var pixelRepresentation = dataSet.uint16('x00280103');\n  var bitsStored = dataSet.uint16('x00280101');\n\n  if (pixelRepresentation === 0) {\n    return 0;\n  }\n\n  return -1 << bitsStored - 1;\n}\n\n// 0 = unsigned / US, 1 = signed / SS\nfunction getModalityLUTOutputPixelRepresentation(dataSet) {\n\n  // CT SOP Classes are always signed\n  var sopClassUID = dataSet.string('x00080016');\n\n  if (sopClassUID === '1.2.840.10008.5.1.4.1.1.2' || sopClassUID === '1.2.840.10008.5.1.4.1.1.2.1') {\n    return 1;\n  }\n\n  // if rescale intercept and rescale slope are present, pass the minimum stored\n  // pixel value through them to see if we get a signed output range\n  var rescaleIntercept = dataSet.floatString('x00281052');\n  var rescaleSlope = dataSet.floatString('x00281053');\n\n  if (rescaleIntercept !== undefined && rescaleSlope !== undefined) {\n    var minStoredPixelValue = getMinStoredPixelValue(dataSet); //\n    var minModalityLutValue = minStoredPixelValue * rescaleSlope + rescaleIntercept;\n\n    if (minModalityLutValue < 0) {\n      return 1;\n    }\n\n    return 0;\n  }\n\n  // Output of non linear modality lut is always unsigned\n  if (dataSet.elements.x00283000 && dataSet.elements.x00283000.length > 0) {\n    return 0;\n  }\n\n  // If no modality lut transform, output is same as pixel representation\n  return dataSet.uint16('x00280103');\n}\n\nexports.default = getModalityLUTOutputPixelRepresentation;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nfunction getNumberValues(dataSet, tag, minimumLength) {\n  var values = [];\n  var valueAsString = dataSet.string(tag);\n\n  if (!valueAsString) {\n    return;\n  }\n  var split = valueAsString.split('\\\\');\n\n  if (minimumLength && split.length < minimumLength) {\n    return;\n  }\n  for (var i = 0; i < split.length; i++) {\n    values.push(parseFloat(split[i]));\n  }\n\n  return values;\n}\n\nexports.default = getNumberValues;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _index = __webpack_require__(18);\n\nvar _findIndexOfString = __webpack_require__(21);\n\nvar _findIndexOfString2 = _interopRequireDefault(_findIndexOfString);\n\nvar _getPixelData = __webpack_require__(22);\n\nvar _getPixelData2 = _interopRequireDefault(_getPixelData);\n\nvar _metaDataManager = __webpack_require__(5);\n\nvar _metaDataManager2 = _interopRequireDefault(_metaDataManager);\n\nvar _loadImage = __webpack_require__(23);\n\nvar _loadImage2 = _interopRequireDefault(_loadImage);\n\nvar _register = __webpack_require__(52);\n\nvar _register2 = _interopRequireDefault(_register);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar metaData = {\n  getNumberString: _index.getNumberString,\n  getNumberValue: _index.getNumberValue,\n  getNumberValues: _index.getNumberValues,\n  getValue: _index.getValue,\n  metaDataProvider: _index.metaDataProvider\n};\n\nexports.default = {\n  metaData: metaData,\n  findIndexOfString: _findIndexOfString2.default,\n  getPixelData: _getPixelData2.default,\n  loadImage: _loadImage2.default,\n  metaDataManager: _metaDataManager2.default,\n  register: _register2.default\n};\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getNumberString = __webpack_require__(49);\n\nObject.defineProperty(exports, 'getNumberString', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getNumberString).default;\n  }\n});\n\nvar _getNumberValue = __webpack_require__(19);\n\nObject.defineProperty(exports, 'getNumberValue', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getNumberValue).default;\n  }\n});\n\nvar _getNumberValues = __webpack_require__(20);\n\nObject.defineProperty(exports, 'getNumberValues', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getNumberValues).default;\n  }\n});\n\nvar _getValue = __webpack_require__(3);\n\nObject.defineProperty(exports, 'getValue', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getValue).default;\n  }\n});\n\nvar _metaDataProvider = __webpack_require__(50);\n\nObject.defineProperty(exports, 'metaDataProvider', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_metaDataProvider).default;\n  }\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getValue = __webpack_require__(3);\n\nvar _getValue2 = _interopRequireDefault(_getValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getNumberValue(element, index) {\n  var value = (0, _getValue2.default)(element, index);\n\n  if (value === undefined) {\n    return;\n  }\n\n  return parseFloat(value);\n}\n\nexports.default = getNumberValue;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n\n/**\n * Returns the values as an array of javascript numbers\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param [minimumLength] - the minimum number of values\n * @returns {*}\n */\nfunction getNumberValues(element, minimumLength) {\n  if (!element) {\n    return;\n  }\n  // Value is not present if the attribute has a zero length value\n  if (!element.Value) {\n    return;\n  }\n  // make sure we have the expected length\n  if (minimumLength && element.Value.length < minimumLength) {\n    return;\n  }\n\n  var values = [];\n\n  for (var i = 0; i < element.Value.length; i++) {\n    values.push(parseFloat(element.Value[i]));\n  }\n\n  return values;\n}\n\nexports.default = getNumberValues;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nfunction checkToken(token, data, dataOffset) {\n\n  if (dataOffset + token.length > data.length) {\n    return false;\n  }\n\n  var endIndex = dataOffset;\n\n  for (var i = 0; i < token.length; i++) {\n    if (token[i] !== data[endIndex++]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction stringToUint8Array(str) {\n  var uint = new Uint8Array(str.length);\n\n  for (var i = 0, j = str.length; i < j; i++) {\n    uint[i] = str.charCodeAt(i);\n  }\n\n  return uint;\n}\n\nfunction findIndexOfString(data, str, offset) {\n\n  offset = offset || 0;\n\n  var token = stringToUint8Array(str);\n\n  for (var i = offset; i < data.length; i++) {\n    if (token[0] === data[i]) {\n      // console.log('match @', i);\n      if (checkToken(token, data, i)) {\n        return i;\n      }\n    }\n  }\n\n  return -1;\n}\nexports.default = findIndexOfString;\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _index = __webpack_require__(1);\n\nvar _findIndexOfString = __webpack_require__(21);\n\nvar _findIndexOfString2 = _interopRequireDefault(_findIndexOfString);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction findBoundary(header) {\n  for (var i = 0; i < header.length; i++) {\n    if (header[i].substr(0, 2) === '--') {\n      return header[i];\n    }\n  }\n}\n\nfunction findContentType(header) {\n  for (var i = 0; i < header.length; i++) {\n    if (header[i].substr(0, 13) === 'Content-Type:') {\n      return header[i].substr(13).trim();\n    }\n  }\n}\n\nfunction uint8ArrayToString(data, offset, length) {\n  offset = offset || 0;\n  length = length || data.length - offset;\n  var str = '';\n\n  for (var i = offset; i < offset + length; i++) {\n    str += String.fromCharCode(data[i]);\n  }\n\n  return str;\n}\n\nfunction getPixelData(uri, imageId) {\n  var mediaType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'application/octet-stream';\n\n  var headers = {\n    accept: mediaType\n  };\n\n  return new Promise(function (resolve, reject) {\n    var loadPromise = (0, _index.xhrRequest)(uri, imageId, headers);\n\n    loadPromise.then(function (imageFrameAsArrayBuffer /* , xhr*/) {\n\n      // request succeeded, Parse the multi-part mime response\n      var response = new Uint8Array(imageFrameAsArrayBuffer);\n\n      // First look for the multipart mime header\n      var tokenIndex = (0, _findIndexOfString2.default)(response, '\\r\\n\\r\\n');\n\n      if (tokenIndex === -1) {\n        reject(new Error('invalid response - no multipart mime header'));\n      }\n      var header = uint8ArrayToString(response, 0, tokenIndex);\n      // Now find the boundary  marker\n      var split = header.split('\\r\\n');\n      var boundary = findBoundary(split);\n\n      if (!boundary) {\n        reject(new Error('invalid response - no boundary marker'));\n      }\n      var offset = tokenIndex + 4; // skip over the \\r\\n\\r\\n\n\n      // find the terminal boundary marker\n      var endIndex = (0, _findIndexOfString2.default)(response, boundary, offset);\n\n      if (endIndex === -1) {\n        reject(new Error('invalid response - terminating boundary not found'));\n      }\n\n      // Remove \\r\\n from the length\n      var length = endIndex - offset - 2;\n\n      // return the info for this pixel data\n      resolve({\n        contentType: findContentType(split),\n        imageFrame: {\n          pixelData: new Uint8Array(imageFrameAsArrayBuffer, offset, length)\n        }\n      });\n    });\n  });\n}\n\nexports.default = getPixelData;\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _externalModules = __webpack_require__(0);\n\nvar _metaDataManager = __webpack_require__(5);\n\nvar _metaDataManager2 = _interopRequireDefault(_metaDataManager);\n\nvar _getPixelData = __webpack_require__(22);\n\nvar _getPixelData2 = _interopRequireDefault(_getPixelData);\n\nvar _createImage = __webpack_require__(7);\n\nvar _createImage2 = _interopRequireDefault(_createImage);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getTransferSyntaxForContentType() /* contentType */{\n  return '1.2.840.10008.1.2'; // hard code to ILE for now\n}\n\nfunction loadImage(imageId, options) {\n  var start = new Date().getTime();\n  var uri = imageId.substring(7);\n\n  var deferred = _externalModules.$.Deferred();\n\n  // check to make sure we have metadata for this imageId\n  var metaData = _metaDataManager2.default.get(imageId);\n\n  if (metaData === undefined) {\n    deferred.reject('no metadata for imageId ' + imageId);\n\n    return deferred.promise();\n  }\n\n  // TODO: load bulk data items that we might need\n  var mediaType = 'multipart/related; type=\"application/octet-stream\"'; // 'image/dicom+jp2';\n\n  // get the pixel data from the server\n  (0, _getPixelData2.default)(uri, imageId, mediaType).then(function (result) {\n\n    var transferSyntax = getTransferSyntaxForContentType(result.contentType);\n    var pixelData = result.imageFrame.pixelData;\n    var imagePromise = (0, _createImage2.default)(imageId, pixelData, transferSyntax, options);\n\n    imagePromise.then(function (image) {\n      // add the loadTimeInMS property\n      var end = new Date().getTime();\n\n      image.loadTimeInMS = end - start;\n      deferred.resolve(image);\n    }, function (reason) {\n      deferred.reject(reason);\n    });\n  }, function (reason) {\n    deferred.reject(reason);\n  });\n\n  return deferred;\n}\n\nexports.default = loadImage;\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _externalModules = __webpack_require__(0);\n\nfunction getImageFrame(imageId) {\n  var imagePixelModule = _externalModules.external.cornerstone.metaData.get('imagePixelModule', imageId);\n\n  return {\n    samplesPerPixel: imagePixelModule.samplesPerPixel,\n    photometricInterpretation: imagePixelModule.photometricInterpretation,\n    planarConfiguration: imagePixelModule.planarConfiguration,\n    rows: imagePixelModule.rows,\n    columns: imagePixelModule.columns,\n    bitsAllocated: imagePixelModule.bitsAllocated,\n    pixelRepresentation: imagePixelModule.pixelRepresentation, // 0 = unsigned,\n    smallestPixelValue: imagePixelModule.smallestPixelValue,\n    largestPixelValue: imagePixelModule.largestPixelValue,\n    redPaletteColorLookupTableDescriptor: imagePixelModule.redPaletteColorLookupTableDescriptor,\n    greenPaletteColorLookupTableDescriptor: imagePixelModule.greenPaletteColorLookupTableDescriptor,\n    bluePaletteColorLookupTableDescriptor: imagePixelModule.bluePaletteColorLookupTableDescriptor,\n    redPaletteColorLookupTableData: imagePixelModule.redPaletteColorLookupTableData,\n    greenPaletteColorLookupTableData: imagePixelModule.greenPaletteColorLookupTableData,\n    bluePaletteColorLookupTableData: imagePixelModule.bluePaletteColorLookupTableData,\n    pixelData: undefined // populated later after decoding\n  };\n}\n\nexports.default = getImageFrame;\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _webWorkerManager = __webpack_require__(26);\n\nvar _webWorkerManager2 = _interopRequireDefault(_webWorkerManager);\n\nvar _decodeJPEGBaseline8BitColor = __webpack_require__(27);\n\nvar _decodeJPEGBaseline8BitColor2 = _interopRequireDefault(_decodeJPEGBaseline8BitColor);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction addDecodeTask(imageFrame, transferSyntax, pixelData, options) {\n  var priority = options.priority || undefined;\n  var transferList = options.transferPixelData ? [pixelData.buffer] : undefined;\n\n  return _webWorkerManager2.default.addTask('decodeTask', {\n    imageFrame: imageFrame,\n    transferSyntax: transferSyntax,\n    pixelData: pixelData,\n    options: options\n  }, priority, transferList).promise;\n}\n\nfunction decodeImageFrame(imageFrame, transferSyntax, pixelData, canvas) {\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n  // TODO: Turn this into a switch statement instead\n  if (transferSyntax === '1.2.840.10008.1.2') {\n    // Implicit VR Little Endian\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.1') {\n    // Explicit VR Little Endian\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.2') {\n    // Explicit VR Big Endian (retired)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.1.99') {\n    // Deflate transfer syntax (deflated by dicomParser)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.5') {\n    // RLE Lossless\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.50') {\n    // JPEG Baseline lossy process 1 (8 bit)\n\n    // Handle 8-bit JPEG Baseline color images using the browser's built-in\n    // JPEG decoding\n    if (imageFrame.bitsAllocated === 8 && (imageFrame.samplesPerPixel === 3 || imageFrame.samplesPerPixel === 4)) {\n      return (0, _decodeJPEGBaseline8BitColor2.default)(imageFrame, pixelData, canvas);\n    }\n\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.51') {\n    // JPEG Baseline lossy process 2 & 4 (12 bit)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.57') {\n    // JPEG Lossless, Nonhierarchical (Processes 14)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.70') {\n    // JPEG Lossless, Nonhierarchical (Processes 14 [Selection 1])\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.80') {\n    // JPEG-LS Lossless Image Compression\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.81') {\n    // JPEG-LS Lossy (Near-Lossless) Image Compression\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.90') {\n    // JPEG 2000 Lossless\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.91') {\n    // JPEG 2000 Lossy\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  }\n\n  /* Don't know if these work...\n   // JPEG 2000 Part 2 Multicomponent Image Compression (Lossless Only)\n   else if(transferSyntax === \"1.2.840.10008.1.2.4.92\")\n   {\n   return cornerstoneWADOImageLoader.decodeJPEG2000(dataSet, frame);\n   }\n   // JPEG 2000 Part 2 Multicomponent Image Compression\n   else if(transferSyntax === \"1.2.840.10008.1.2.4.93\")\n   {\n   return cornerstoneWADOImageLoader.decodeJPEG2000(dataSet, frame);\n   }\n   */\n\n  throw new Error('No decoder for transfer syntax ' + transferSyntax);\n}\n\nexports.default = decodeImageFrame;\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _options = __webpack_require__(6);\n\n// the taskId to assign to the next task added via addTask()\nvar nextTaskId = 0;\n\n// array of queued tasks sorted with highest priority task first\nvar tasks = [];\n\n// array of web workers to dispatch decode tasks to\nvar webWorkers = [];\n\n// The options for CornerstoneWADOImageLoader\nvar options = (0, _options.getOptions)();\n\nvar defaultConfig = {\n  maxWebWorkers: navigator.hardwareConcurrency || 1,\n  startWebWorkersOnDemand: true,\n  webWorkerPath: '../../dist/cornerstoneWADOImageLoaderWebWorker.js',\n  webWorkerTaskPaths: [],\n  taskConfiguration: {\n    decodeTask: {\n      loadCodecsOnStartup: true,\n      initializeCodecsOnStartup: false,\n      codecsPath: '../dist/cornerstoneWADOImageLoaderCodecs.js',\n      usePDFJS: false,\n      strict: options.strict\n    }\n  }\n};\n\nvar config = void 0;\n\nvar statistics = {\n  maxWebWorkers: 0,\n  numWebWorkers: 0,\n  numTasksQueued: 0,\n  numTasksExecuting: 0,\n  numTasksCompleted: 0,\n  totalTaskTimeInMS: 0,\n  totalTimeDelayedInMS: 0\n};\n\n/**\n * Function to start a task on a web worker\n */\nfunction startTaskOnWebWorker() {\n  // return immediately if no decode tasks to do\n  if (!tasks.length) {\n    return;\n  }\n\n  // look for a web worker that is ready\n  for (var i = 0; i < webWorkers.length; i++) {\n    if (webWorkers[i].status === 'ready') {\n      // mark it as busy so tasks are not assigned to it\n      webWorkers[i].status = 'busy';\n\n      // get the highest priority task\n      var task = tasks.shift();\n\n      task.start = new Date().getTime();\n\n      // update stats with how long this task was delayed (waiting in queue)\n      var end = new Date().getTime();\n\n      statistics.totalTimeDelayedInMS += end - task.added;\n\n      // assign this task to this web worker and send the web worker\n      // a message to execute it\n      webWorkers[i].task = task;\n      webWorkers[i].worker.postMessage({\n        taskType: task.taskType,\n        workerIndex: i,\n        data: task.data\n      }, task.transferList);\n      statistics.numTasksExecuting++;\n\n      return;\n    }\n  }\n\n  // if no available web workers and we haven't started max web workers, start a new one\n  if (webWorkers.length < config.maxWebWorkers) {\n    spawnWebWorker();\n  }\n}\n\n/**\n * Function to handle a message from a web worker\n * @param msg\n */\nfunction handleMessageFromWorker(msg) {\n  // console.log('handleMessageFromWorker', msg.data);\n  if (msg.data.taskType === 'initialize') {\n    webWorkers[msg.data.workerIndex].status = 'ready';\n    startTaskOnWebWorker();\n  } else {\n    var start = webWorkers[msg.data.workerIndex].task.start;\n\n    webWorkers[msg.data.workerIndex].task.deferred.resolve(msg.data.result);\n    webWorkers[msg.data.workerIndex].task = undefined;\n\n    statistics.numTasksExecuting--;\n    webWorkers[msg.data.workerIndex].status = 'ready';\n    statistics.numTasksCompleted++;\n\n    var end = new Date().getTime();\n\n    statistics.totalTaskTimeInMS += end - start;\n\n    startTaskOnWebWorker();\n  }\n}\n\n/**\n * Spawns a new web worker\n */\nfunction spawnWebWorker() {\n  // prevent exceeding maxWebWorkers\n  if (webWorkers.length >= config.maxWebWorkers) {\n    return;\n  }\n\n  // spawn the webworker\n  var worker = new Worker(config.webWorkerPath);\n\n  webWorkers.push({\n    worker: worker,\n    status: 'initializing'\n  });\n  worker.addEventListener('message', handleMessageFromWorker);\n  worker.postMessage({\n    taskType: 'initialize',\n    workerIndex: webWorkers.length - 1,\n    config: config\n  });\n}\n\n/**\n * Initialization function for the web worker manager - spawns web workers\n * @param configObject\n */\nfunction initialize(configObject) {\n  configObject = configObject || defaultConfig;\n\n  // prevent being initialized more than once\n  if (config) {\n    throw new Error('WebWorkerManager already initialized');\n  }\n\n  config = configObject;\n\n  config.maxWebWorkers = config.maxWebWorkers || navigator.hardwareConcurrency || 1;\n\n  // Spawn new web workers\n  if (!config.startWebWorkersOnDemand) {\n    for (var i = 0; i < config.maxWebWorkers; i++) {\n      spawnWebWorker();\n    }\n  }\n}\n\n/**\n * dynamically loads a web worker task\n * @param sourcePath\n * @param taskConfig\n */\nfunction loadWebWorkerTask(sourcePath, taskConfig) {\n  // add it to the list of web worker tasks paths so on demand web workers\n  // load this properly\n  config.webWorkerTaskPaths.push(sourcePath);\n\n  // if a task specific configuration is provided, merge it into the config\n  if (taskConfig) {\n    config.taskConfiguration = Object.assign(config.taskConfiguration, taskConfig);\n  }\n\n  // tell each spawned web worker to load this task\n  for (var i = 0; i < webWorkers.length; i++) {\n    webWorkers[i].worker.postMessage({\n      taskType: 'loadWebWorkerTask',\n      workerIndex: webWorkers.length - 1,\n      sourcePath: sourcePath,\n      config: config\n    });\n  }\n}\n\n/**\n * Function to add a decode task to be performed\n *\n * @param taskType - the taskType for this task\n * @param data - data specific to the task\n * @param priority - optional priority of the task (defaults to 0), > 0 is higher, < 0 is lower\n * @param transferList - optional array of data to transfer to web worker\n * @returns {*}\n */\nfunction addTask(taskType, data) {\n  var priority = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var transferList = arguments[3];\n\n  if (!config) {\n    initialize();\n  }\n\n  var deferred = {};\n  var promise = new Promise(function (resolve, reject) {\n    deferred = {\n      resolve: resolve,\n      reject: reject\n    };\n  });\n\n  // find the right spot to insert this decode task (based on priority)\n  var i = void 0;\n\n  for (i = 0; i < tasks.length; i++) {\n    if (tasks[i].priority < priority) {\n      break;\n    }\n  }\n\n  var taskId = nextTaskId++;\n\n  // insert the decode task at position i\n  tasks.splice(i, 0, {\n    taskId: taskId,\n    taskType: taskType,\n    status: 'ready',\n    added: new Date().getTime(),\n    data: data,\n    deferred: deferred,\n    priority: priority,\n    transferList: transferList\n  });\n\n  // try to start a task on the web worker since we just added a new task and a web worker may be available\n  startTaskOnWebWorker();\n\n  return {\n    taskId: taskId,\n    promise: promise\n  };\n}\n\n/**\n * Changes the priority of a queued task\n * @param taskId - the taskId to change the priority of\n * @param priority - priority of the task (defaults to 0), > 0 is higher, < 0 is lower\n * @returns boolean - true on success, false if taskId not found\n */\nfunction setTaskPriority(taskId) {\n  var priority = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  // search for this taskId\n  for (var i = 0; i < tasks.length; i++) {\n    if (tasks[i].taskId === taskId) {\n      // taskId found, remove it\n      var task = tasks.splice(i, 1)[0];\n\n      // set its priority\n      task.priority = priority;\n\n      // find the right spot to insert this decode task (based on priority)\n      for (i = 0; i < tasks.length; i++) {\n        if (tasks[i].priority < priority) {\n          break;\n        }\n      }\n\n      // insert the decode task at position i\n      tasks.splice(i, 0, task);\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Cancels a queued task and rejects\n * @param taskId - the taskId to cancel\n * @param reason - optional reason the task was rejected\n * @returns boolean - true on success, false if taskId not found\n */\nfunction cancelTask(taskId, reason) {\n  // search for this taskId\n  for (var i = 0; i < tasks.length; i++) {\n    if (tasks[i].taskId === taskId) {\n      // taskId found, remove it\n      var task = tasks.splice(i, 1);\n\n      task.deferred.reject(reason);\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Function to return the statistics on running web workers\n * @returns object containing statistics\n */\nfunction getStatistics() {\n  statistics.maxWebWorkers = config.maxWebWorkers;\n  statistics.numWebWorkers = webWorkers.length;\n  statistics.numTasksQueued = tasks.length;\n\n  return statistics;\n}\n\nexports.default = {\n  initialize: initialize,\n  loadWebWorkerTask: loadWebWorkerTask,\n  addTask: addTask,\n  getStatistics: getStatistics,\n  setTaskPriority: setTaskPriority,\n  cancelTask: cancelTask\n};\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getMinMax = __webpack_require__(2);\n\nvar _getMinMax2 = _interopRequireDefault(_getMinMax);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Special decoder for 8 bit jpeg that leverages the browser's built in JPEG decoder for increased performance\n */\n\nfunction arrayBufferToString(buffer) {\n  return binaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(new Uint8Array(buffer))));\n}\n\nfunction binaryToString(binary) {\n  var error = void 0;\n\n  try {\n    return decodeURIComponent(escape(binary));\n  } catch (_error) {\n    error = _error;\n    if (error instanceof URIError) {\n      return binary;\n    }\n    throw error;\n  }\n}\n\nfunction decodeJPEGBaseline8BitColor(imageFrame, pixelData, canvas) {\n  var start = new Date().getTime();\n  var imgBlob = new Blob([pixelData], { type: 'image/jpeg' });\n\n  return new Promise(function (resolve, reject) {\n    var fileReader = new FileReader();\n\n    if (fileReader.readAsBinaryString === undefined) {\n      fileReader.readAsArrayBuffer(imgBlob);\n    } else {\n      fileReader.readAsBinaryString(imgBlob); // doesn't work on IE11\n    }\n\n    fileReader.onload = function () {\n      var img = new Image();\n\n      img.onload = function () {\n        canvas.height = img.height;\n        canvas.width = img.width;\n        imageFrame.rows = img.height;\n        imageFrame.columns = img.width;\n        var context = canvas.getContext('2d');\n\n        context.drawImage(this, 0, 0);\n        var imageData = context.getImageData(0, 0, img.width, img.height);\n        var end = new Date().getTime();\n\n        imageFrame.pixelData = imageData.data;\n        imageFrame.imageData = imageData;\n        imageFrame.decodeTimeInMS = end - start;\n\n        // calculate smallest and largest PixelValue\n        var minMax = (0, _getMinMax2.default)(imageFrame.pixelData);\n\n        imageFrame.smallestPixelValue = minMax.min;\n        imageFrame.largestPixelValue = minMax.max;\n\n        resolve(imageFrame);\n      };\n\n      img.onerror = function (error) {\n        reject(error);\n      };\n\n      if (fileReader.readAsBinaryString === undefined) {\n        img.src = 'data:image/jpeg;base64,' + window.btoa(arrayBufferToString(fileReader.result));\n      } else {\n        img.src = 'data:image/jpeg;base64,' + window.btoa(fileReader.result); // doesn't work on IE11\n      }\n    };\n\n    fileReader.onerror = function (e) {\n      reject(e);\n    };\n  });\n}\n\nexports.default = decodeJPEGBaseline8BitColor;\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (photoMetricInterpretation) {\n  return photoMetricInterpretation === 'RGB' || photoMetricInterpretation === 'PALETTE COLOR' || photoMetricInterpretation === 'YBR_FULL' || photoMetricInterpretation === 'YBR_FULL_422' || photoMetricInterpretation === 'YBR_PARTIAL_422' || photoMetricInterpretation === 'YBR_PARTIAL_420' || photoMetricInterpretation === 'YBR_RCT' || photoMetricInterpretation === 'YBR_ICT';\n};\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = convertColorSpace;\n\nvar _index = __webpack_require__(10);\n\nfunction convertRGB(imageFrame, rgbaBuffer) {\n  if (imageFrame.planarConfiguration === 0) {\n    (0, _index.convertRGBColorByPixel)(imageFrame.pixelData, rgbaBuffer);\n  } else {\n    (0, _index.convertRGBColorByPlane)(imageFrame.pixelData, rgbaBuffer);\n  }\n}\n\nfunction convertYBRFull(imageFrame, rgbaBuffer) {\n  if (imageFrame.planarConfiguration === 0) {\n    (0, _index.convertYBRFullByPixel)(imageFrame.pixelData, rgbaBuffer);\n  } else {\n    (0, _index.convertYBRFullByPlane)(imageFrame.pixelData, rgbaBuffer);\n  }\n}\n\nfunction convertColorSpace(imageFrame, imageData) {\n  var rgbaBuffer = imageData.data;\n  // convert based on the photometric interpretation\n\n  if (imageFrame.photometricInterpretation === 'RGB') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'YBR_RCT') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'YBR_ICT') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'PALETTE COLOR') {\n    (0, _index.convertPALETTECOLOR)(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'YBR_FULL_422') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'YBR_FULL') {\n    convertYBRFull(imageFrame, rgbaBuffer);\n  } else {\n    throw new Error('No color space conversion for photometric interpretation ' + imageFrame.photometricInterpretation);\n  }\n}\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nfunction isJPEGBaseline8BitColor(imageFrame, transferSyntax) {\n  transferSyntax = transferSyntax || imageFrame.transferSyntax;\n\n  if (imageFrame.bitsAllocated === 8 && transferSyntax === '1.2.840.10008.1.2.4.50' && (imageFrame.samplesPerPixel === 3 || imageFrame.samplesPerPixel === 4)) {\n    return true;\n  }\n}\n\nexports.default = isJPEGBaseline8BitColor;\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar files = [];\n\nfunction add(file) {\n  var fileIndex = files.push(file);\n\n  return \"dicomfile:\" + (fileIndex - 1);\n}\n\nfunction get(index) {\n  return files[index];\n}\n\nfunction remove(index) {\n  files[index] = undefined;\n}\n\nfunction purge() {\n  files = [];\n}\n\nexports.default = {\n  add: add,\n  get: get,\n  remove: remove,\n  purge: purge\n};\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = getEncapsulatedImageFrame;\n\nvar _externalModules = __webpack_require__(0);\n\n/**\n * Function to deal with extracting an image frame from an encapsulated data set.\n */\n\nfunction framesAreFragmented(dataSet) {\n  var numberOfFrames = dataSet.intString('x00280008');\n  var pixelDataElement = dataSet.elements.x7fe00010;\n\n  return numberOfFrames !== pixelDataElement.fragments.length;\n}\n\nfunction getEncapsulatedImageFrame(dataSet, frameIndex) {\n  if (dataSet.elements.x7fe00010.basicOffsetTable.length) {\n    // Basic Offset Table is not empty\n    return _externalModules.dicomParser.readEncapsulatedImageFrame(dataSet, dataSet.elements.x7fe00010, frameIndex);\n  }\n\n  // Empty basic offset table\n\n  if (framesAreFragmented(dataSet)) {\n    var basicOffsetTable = _externalModules.dicomParser.createJPEGBasicOffsetTable(dataSet, dataSet.elements.x7fe00010);\n\n    return _externalModules.dicomParser.readEncapsulatedImageFrame(dataSet, dataSet.elements.x7fe00010, frameIndex, basicOffsetTable);\n  }\n\n  return _externalModules.dicomParser.readEncapsulatedPixelDataFromFragments(dataSet, dataSet.elements.x7fe00010, frameIndex);\n}\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _unpackBinaryFrame = __webpack_require__(34);\n\nvar _unpackBinaryFrame2 = _interopRequireDefault(_unpackBinaryFrame);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Function to deal with extracting an image frame from an encapsulated data set.\n */\n\nfunction getUncompressedImageFrame(dataSet, frameIndex) {\n  var pixelDataElement = dataSet.elements.x7fe00010;\n  var bitsAllocated = dataSet.uint16('x00280100');\n  var rows = dataSet.uint16('x00280010');\n  var columns = dataSet.uint16('x00280011');\n  var samplesPerPixel = dataSet.uint16('x00280002');\n\n  var pixelDataOffset = pixelDataElement.dataOffset;\n  var pixelsPerFrame = rows * columns * samplesPerPixel;\n\n  var frameOffset = void 0;\n\n  if (bitsAllocated === 8) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return new Uint8Array(dataSet.byteArray.buffer, frameOffset, pixelsPerFrame);\n  } else if (bitsAllocated === 16) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame * 2;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return new Uint8Array(dataSet.byteArray.buffer, frameOffset, pixelsPerFrame * 2);\n  } else if (bitsAllocated === 1) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame * 0.125;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return (0, _unpackBinaryFrame2.default)(dataSet.byteArray, frameOffset, pixelsPerFrame);\n  }\n\n  throw new Error('unsupported pixel format');\n}\n\nexports.default = getUncompressedImageFrame;\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/* eslint no-bitwise: 0 */\n\nfunction isBitSet(byte, bitPos) {\n  return byte & 1 << bitPos;\n}\n\n/**\n * Function to deal with unpacking a binary frame\n */\nfunction unpackBinaryFrame(byteArray, frameOffset, pixelsPerFrame) {\n  // Create a new pixel array given the image size\n  var pixelData = new Uint8Array(pixelsPerFrame);\n\n  for (var i = 0; i < pixelsPerFrame; i++) {\n    // Compute byte position\n    var bytePos = Math.floor(i / 8);\n\n    // Get the current byte\n    var byte = byteArray[bytePos + frameOffset];\n\n    // Bit position (0-7) within byte\n    var bitPos = i % 8;\n\n    // Check whether bit at bitpos is set\n    pixelData[i] = isBitSet(byte, bitPos) ? 1 : 0;\n  }\n\n  return pixelData;\n}\n\nexports.default = unpackBinaryFrame;\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _parseImageId = __webpack_require__(4);\n\nvar _parseImageId2 = _interopRequireDefault(_parseImageId);\n\nvar _fileManager = __webpack_require__(31);\n\nvar _fileManager2 = _interopRequireDefault(_fileManager);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction loadFileRequest(uri) {\n  var parsedImageId = (0, _parseImageId2.default)(uri);\n  var fileIndex = parseInt(parsedImageId.url, 10);\n  var file = _fileManager2.default.get(fileIndex);\n\n  return new Promise(function (resolve, reject) {\n    var fileReader = new FileReader();\n\n    fileReader.onload = function (e) {\n      var dicomPart10AsArrayBuffer = e.target.result;\n\n      resolve(dicomPart10AsArrayBuffer);\n    };\n\n    fileReader.onerror = reject;\n\n    fileReader.readAsArrayBuffer(file);\n  });\n}\n\nexports.default = loadFileRequest;\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.loadImage = exports.getLoaderForScheme = exports.loadImageFromPromise = undefined;\n\nvar _externalModules = __webpack_require__(0);\n\nvar _createImage = __webpack_require__(7);\n\nvar _createImage2 = _interopRequireDefault(_createImage);\n\nvar _parseImageId = __webpack_require__(4);\n\nvar _parseImageId2 = _interopRequireDefault(_parseImageId);\n\nvar _dataSetCacheManager = __webpack_require__(8);\n\nvar _dataSetCacheManager2 = _interopRequireDefault(_dataSetCacheManager);\n\nvar _loadFileRequest = __webpack_require__(35);\n\nvar _loadFileRequest2 = _interopRequireDefault(_loadFileRequest);\n\nvar _getPixelData = __webpack_require__(53);\n\nvar _getPixelData2 = _interopRequireDefault(_getPixelData);\n\nvar _index = __webpack_require__(1);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// add a decache callback function to clear out our dataSetCacheManager\nfunction addDecache(image) {\n  image.decache = function () {\n    // console.log('decache');\n    var parsedImageId = (0, _parseImageId2.default)(image.imageId);\n\n    _dataSetCacheManager2.default.unload(parsedImageId.url);\n  };\n}\n\nfunction loadImageFromPromise(dataSetPromise, imageId) {\n  var frame = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var sharedCacheKey = arguments[3];\n  var options = arguments[4];\n\n  var start = new Date().getTime();\n  var deferred = _externalModules.$.Deferred();\n\n  dataSetPromise.then(function (dataSet /* , xhr*/) {\n    var pixelData = (0, _getPixelData2.default)(dataSet, frame);\n    var transferSyntax = dataSet.string('x00020010');\n    var loadEnd = new Date().getTime();\n    var imagePromise = (0, _createImage2.default)(imageId, pixelData, transferSyntax, options);\n\n    imagePromise.then(function (image) {\n      image.data = dataSet;\n      image.sharedCacheKey = sharedCacheKey;\n      var end = new Date().getTime();\n\n      image.loadTimeInMS = loadEnd - start;\n      image.totalTimeInMS = end - start;\n      addDecache(image);\n      deferred.resolve(image);\n    }, function (error) {\n      deferred.reject(error);\n    });\n  }, function (error) {\n    deferred.reject(error);\n  });\n\n  return deferred;\n}\n\nfunction loadImageFromDataSet(dataSet, imageId) {\n  var frame = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var sharedCacheKey = arguments[3];\n  var options = arguments[4];\n\n  var start = new Date().getTime();\n  var deferred = _externalModules.$.Deferred();\n\n  var pixelData = (0, _getPixelData2.default)(dataSet, frame);\n  var transferSyntax = dataSet.string('x00020010');\n  var loadEnd = new Date().getTime();\n  var imagePromise = (0, _createImage2.default)(imageId, pixelData, transferSyntax, options);\n\n  imagePromise.then(function (image) {\n    image.data = dataSet;\n    image.sharedCacheKey = sharedCacheKey;\n    var end = new Date().getTime();\n\n    image.loadTimeInMS = loadEnd - start;\n    image.totalTimeInMS = end - start;\n    addDecache(image);\n    deferred.resolve(image);\n  }, function (error) {\n    deferred.reject(error);\n  });\n\n  return deferred;\n}\n\nfunction getLoaderForScheme(scheme) {\n  if (scheme === 'dicomweb' || scheme === 'wadouri') {\n    return _index.xhrRequest;\n  } else if (scheme === 'dicomfile') {\n    return _loadFileRequest2.default;\n  }\n}\n\nfunction loadImage(imageId, options) {\n  var parsedImageId = (0, _parseImageId2.default)(imageId);\n  var loader = getLoaderForScheme(parsedImageId.scheme);\n\n  // if the dataset for this url is already loaded, use it\n  if (_dataSetCacheManager2.default.isLoaded(parsedImageId.url)) {\n    var dataSet = _dataSetCacheManager2.default.get(parsedImageId.url, loader, imageId);\n\n    return loadImageFromDataSet(dataSet, imageId, parsedImageId.frame, parsedImageId.url, options);\n  }\n\n  // load the dataSet via the dataSetCacheManager\n  var dataSetPromise = _dataSetCacheManager2.default.load(parsedImageId.url, loader, imageId);\n\n  return loadImageFromPromise(dataSetPromise, imageId, parsedImageId.frame, parsedImageId.url, options);\n}\n\nexports.loadImageFromPromise = loadImageFromPromise;\nexports.getLoaderForScheme = getLoaderForScheme;\nexports.loadImage = loadImage;\n\n/***/ }),\n/* 37 */,\n/* 38 */,\n/* 39 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _index = __webpack_require__(10);\n\nObject.keys(_index).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _index[key];\n    }\n  });\n});\n\nvar _index2 = __webpack_require__(11);\n\nObject.defineProperty(exports, 'wadouri', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_index2).default;\n  }\n});\n\nvar _index3 = __webpack_require__(17);\n\nObject.defineProperty(exports, 'wadors', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_index3).default;\n  }\n});\n\nvar _configure = __webpack_require__(55);\n\nObject.defineProperty(exports, 'configure', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_configure).default;\n  }\n});\n\nvar _convertColorSpace = __webpack_require__(29);\n\nObject.defineProperty(exports, 'convertColorSpace', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_convertColorSpace).default;\n  }\n});\n\nvar _createImage = __webpack_require__(7);\n\nObject.defineProperty(exports, 'createImage', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_createImage).default;\n  }\n});\n\nvar _decodeImageFrame = __webpack_require__(25);\n\nObject.defineProperty(exports, 'decodeImageFrame', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_decodeImageFrame).default;\n  }\n});\n\nvar _decodeJPEGBaseline8BitColor = __webpack_require__(27);\n\nObject.defineProperty(exports, 'decodeJPEGBaseline8BitColor', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_decodeJPEGBaseline8BitColor).default;\n  }\n});\n\nvar _getImageFrame = __webpack_require__(24);\n\nObject.defineProperty(exports, 'getImageFrame', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getImageFrame).default;\n  }\n});\n\nvar _getMinMax = __webpack_require__(2);\n\nObject.defineProperty(exports, 'getMinMax', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_getMinMax).default;\n  }\n});\n\nvar _isColorImage = __webpack_require__(28);\n\nObject.defineProperty(exports, 'isColorImage', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_isColorImage).default;\n  }\n});\n\nvar _isJPEGBaseline8BitColor = __webpack_require__(30);\n\nObject.defineProperty(exports, 'isJPEGBaseline8BitColor', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_isJPEGBaseline8BitColor).default;\n  }\n});\n\nvar _webWorkerManager = __webpack_require__(26);\n\nObject.defineProperty(exports, 'webWorkerManager', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_webWorkerManager).default;\n  }\n});\n\nvar _version = __webpack_require__(9);\n\nObject.defineProperty(exports, 'version', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_version).default;\n  }\n});\n\nvar _index4 = __webpack_require__(1);\n\nObject.defineProperty(exports, 'internal', {\n  enumerable: true,\n  get: function get() {\n    return _index4.internal;\n  }\n});\n\nvar _externalModules = __webpack_require__(0);\n\nObject.defineProperty(exports, 'external', {\n  enumerable: true,\n  get: function get() {\n    return _externalModules.external;\n  }\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: rgbBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: rgbBuffer length must be divisible by 3');\n  }\n\n  var numPixels = imageFrame.length / 3;\n  var rgbIndex = 0;\n  var rgbaIndex = 0;\n\n  for (var i = 0; i < numPixels; i++) {\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // red\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // green\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n};\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: rgbBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: rgbBuffer length must be divisible by 3');\n  }\n\n  var numPixels = imageFrame.length / 3;\n  var rgbaIndex = 0;\n  var rIndex = 0;\n  var gIndex = numPixels;\n  var bIndex = numPixels * 2;\n\n  for (var i = 0; i < numPixels; i++) {\n    rgbaBuffer[rgbaIndex++] = imageFrame[rIndex++]; // red\n    rgbaBuffer[rgbaIndex++] = imageFrame[gIndex++]; // green\n    rgbaBuffer[rgbaIndex++] = imageFrame[bIndex++]; // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n};\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: ybrBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: ybrBuffer length must be divisble by 3');\n  }\n\n  var numPixels = imageFrame.length / 3;\n  var ybrIndex = 0;\n  var rgbaIndex = 0;\n\n  for (var i = 0; i < numPixels; i++) {\n    var y = imageFrame[ybrIndex++];\n    var cb = imageFrame[ybrIndex++];\n    var cr = imageFrame[ybrIndex++];\n\n    rgbaBuffer[rgbaIndex++] = y + 1.40200 * (cr - 128); // red\n    rgbaBuffer[rgbaIndex++] = y - 0.34414 * (cb - 128) - 0.71414 * (cr - 128); // green\n    rgbaBuffer[rgbaIndex++] = y + 1.77200 * (cb - 128); // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n};\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: ybrBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: ybrBuffer length must be divisble by 3');\n  }\n\n  var numPixels = imageFrame.length / 3;\n  var rgbaIndex = 0;\n  var yIndex = 0;\n  var cbIndex = numPixels;\n  var crIndex = numPixels * 2;\n\n  for (var i = 0; i < numPixels; i++) {\n    var y = imageFrame[yIndex++];\n    var cb = imageFrame[cbIndex++];\n    var cr = imageFrame[crIndex++];\n\n    rgbaBuffer[rgbaIndex++] = y + 1.40200 * (cr - 128); // red\n    rgbaBuffer[rgbaIndex++] = y - 0.34414 * (cb - 128) - 0.71414 * (cr - 128); // green\n    rgbaBuffer[rgbaIndex++] = y + 1.77200 * (cb - 128); // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n};\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (imageFrame, rgbaBuffer) {\n  var numPixels = imageFrame.columns * imageFrame.rows;\n  var palIndex = 0;\n  var rgbaIndex = 0;\n  var pixelData = imageFrame.pixelData;\n  var start = imageFrame.redPaletteColorLookupTableDescriptor[1];\n  var rData = imageFrame.redPaletteColorLookupTableData;\n  var gData = imageFrame.greenPaletteColorLookupTableData;\n  var bData = imageFrame.bluePaletteColorLookupTableData;\n  var shift = imageFrame.redPaletteColorLookupTableDescriptor[2] === 8 ? 0 : 8;\n  var len = imageFrame.redPaletteColorLookupTableData.length;\n\n  if (len === 0) {\n    len = 65535;\n  }\n\n  for (var i = 0; i < numPixels; ++i) {\n    var value = pixelData[palIndex++];\n\n    if (value < start) {\n      value = 0;\n    } else if (value > start + len - 1) {\n      value = len - 1;\n    } else {\n      value -= start;\n    }\n\n    rgbaBuffer[rgbaIndex++] = rData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = gData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = bData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = 255;\n  }\n};\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _externalModules = __webpack_require__(0);\n\nvar _getNumberValues = __webpack_require__(16);\n\nvar _getNumberValues2 = _interopRequireDefault(_getNumberValues);\n\nvar _parseImageId = __webpack_require__(4);\n\nvar _parseImageId2 = _interopRequireDefault(_parseImageId);\n\nvar _dataSetCacheManager = __webpack_require__(8);\n\nvar _dataSetCacheManager2 = _interopRequireDefault(_dataSetCacheManager);\n\nvar _getImagePixelModule = __webpack_require__(13);\n\nvar _getImagePixelModule2 = _interopRequireDefault(_getImagePixelModule);\n\nvar _getLUTs = __webpack_require__(14);\n\nvar _getLUTs2 = _interopRequireDefault(_getLUTs);\n\nvar _getModalityLUTOutputPixelRepresentation = __webpack_require__(15);\n\nvar _getModalityLUTOutputPixelRepresentation2 = _interopRequireDefault(_getModalityLUTOutputPixelRepresentation);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction metaDataProvider(type, imageId) {\n  var parsedImageId = (0, _parseImageId2.default)(imageId);\n\n  var dataSet = _dataSetCacheManager2.default.get(parsedImageId.url);\n\n  if (!dataSet) {\n    return;\n  }\n\n  if (type === 'generalSeriesModule') {\n    return {\n      modality: dataSet.string('x00080060'),\n      seriesInstanceUID: dataSet.string('x0020000e'),\n      seriesNumber: dataSet.intString('x00200011'),\n      studyInstanceUID: dataSet.string('x0020000d'),\n      seriesDate: _externalModules.dicomParser.parseDA(dataSet.string('x00080021')),\n      seriesTime: _externalModules.dicomParser.parseTM(dataSet.string('x00080031') || '')\n    };\n  }\n\n  if (type === 'patientStudyModule') {\n    return {\n      patientAge: dataSet.intString('x00101010'),\n      patientSize: dataSet.floatString('x00101020'),\n      patientWeight: dataSet.floatString('x00101030')\n    };\n  }\n\n  if (type === 'imagePlaneModule') {\n    return {\n      pixelSpacing: (0, _getNumberValues2.default)(dataSet, 'x00280030', 2),\n      imageOrientationPatient: (0, _getNumberValues2.default)(dataSet, 'x00200037', 6),\n      imagePositionPatient: (0, _getNumberValues2.default)(dataSet, 'x00200032', 3),\n      sliceThickness: dataSet.floatString('x00180050'),\n      sliceLocation: dataSet.floatString('x00201041'),\n      frameOfReferenceUID: dataSet.string('x00200052')\n    };\n  }\n\n  if (type === 'imagePixelModule') {\n    return (0, _getImagePixelModule2.default)(dataSet);\n  }\n\n  if (type === 'modalityLutModule') {\n    return {\n      rescaleIntercept: dataSet.floatString('x00281052'),\n      rescaleSlope: dataSet.floatString('x00281053'),\n      rescaleType: dataSet.string('x00281054'),\n      modalityLUTSequence: (0, _getLUTs2.default)(dataSet.uint16('x00280103'), dataSet.elements.x00283000)\n    };\n  }\n\n  if (type === 'voiLutModule') {\n    var modalityLUTOutputPixelRepresentation = (0, _getModalityLUTOutputPixelRepresentation2.default)(dataSet);\n\n    return {\n      windowCenter: (0, _getNumberValues2.default)(dataSet, 'x00281050', 1),\n      windowWidth: (0, _getNumberValues2.default)(dataSet, 'x00281051', 1),\n      voiLUTSequence: (0, _getLUTs2.default)(modalityLUTOutputPixelRepresentation, dataSet.elements.x00283010)\n    };\n  }\n\n  if (type === 'sopCommonModule') {\n    return {\n      sopClassUID: dataSet.string('x00080016'),\n      sopInstanceUID: dataSet.string('x00080018')\n    };\n  }\n\n  if (type === 'petIsotopeModule') {\n    var radiopharmaceuticalInfo = dataSet.elements.x00540016;\n\n    if (radiopharmaceuticalInfo === undefined) {\n      return;\n    }\n\n    var firstRadiopharmaceuticalInfoDataSet = radiopharmaceuticalInfo.items[0].dataSet;\n\n    return {\n      radiopharmaceuticalInfo: {\n        radiopharmaceuticalStartTime: _externalModules.dicomParser.parseTM(firstRadiopharmaceuticalInfoDataSet.string('x00181072') || ''),\n        radionuclideTotalDose: firstRadiopharmaceuticalInfoDataSet.floatString('x00181074'),\n        radionuclideHalfLife: firstRadiopharmaceuticalInfoDataSet.floatString('x00181075')\n      }\n    };\n  }\n}\n\nexports.default = metaDataProvider;\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_46__;\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_47__;\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _index = __webpack_require__(17);\n\nvar _index2 = _interopRequireDefault(_index);\n\nvar _index3 = __webpack_require__(11);\n\nvar _index4 = _interopRequireDefault(_index3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Register the WADO-URI and WADO-RS image loaders and metaData providers\n * with an instance of Cornerstone Core.\n *\n * @param cornerstone The Cornerstone Core library to register the image loaders with\n */\nfunction registerLoaders(cornerstone) {\n  _index2.default.register(cornerstone);\n  _index4.default.register(cornerstone);\n}\n\nexports.default = registerLoaders;\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getValue = __webpack_require__(3);\n\nvar _getValue2 = _interopRequireDefault(_getValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Returns the first string value as a Javascript number\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param [index] - the index of the value in a multi-valued element, default is 0\n * @param [defaultValue] - The default value to return if the element does not exist\n * @returns {*}\n */\nfunction getNumberString(element, index, defaultValue) {\n  var value = (0, _getValue2.default)(element, index, defaultValue);\n\n  if (value === undefined) {\n    return;\n  }\n\n  return parseFloat(value);\n}\n\nexports.default = getNumberString;\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _externalModules = __webpack_require__(0);\n\nvar _getNumberValues = __webpack_require__(20);\n\nvar _getNumberValues2 = _interopRequireDefault(_getNumberValues);\n\nvar _getValue = __webpack_require__(3);\n\nvar _getValue2 = _interopRequireDefault(_getValue);\n\nvar _getNumberValue = __webpack_require__(19);\n\nvar _getNumberValue2 = _interopRequireDefault(_getNumberValue);\n\nvar _metaDataManager = __webpack_require__(5);\n\nvar _metaDataManager2 = _interopRequireDefault(_metaDataManager);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction metaDataProvider(type, imageId) {\n  var metaData = _metaDataManager2.default.get(imageId);\n\n  if (!metaData) {\n    return;\n  }\n\n  if (type === 'generalSeriesModule') {\n    return {\n      modality: (0, _getValue2.default)(metaData['00080060']),\n      seriesInstanceUID: (0, _getValue2.default)(metaData['0020000e']),\n      seriesNumber: (0, _getNumberValue2.default)(metaData['00200011']),\n      studyInstanceUID: (0, _getValue2.default)(metaData['0020000d']),\n      seriesDate: _externalModules.dicomParser.parseDA((0, _getValue2.default)(metaData['00080021'])),\n      seriesTime: _externalModules.dicomParser.parseTM((0, _getValue2.default)(metaData['00080031'], 0, ''))\n    };\n  }\n\n  if (type === 'patientStudyModule') {\n    return {\n      patientAge: (0, _getNumberValue2.default)(metaData['00101010']),\n      patientSize: (0, _getNumberValue2.default)(metaData['00101020']),\n      patientWeight: (0, _getNumberValue2.default)(metaData['00101030'])\n    };\n  }\n\n  if (type === 'imagePlaneModule') {\n    return {\n      pixelSpacing: (0, _getNumberValues2.default)(metaData['00280030'], 2),\n      imageOrientationPatient: (0, _getNumberValues2.default)(metaData['00200037'], 6),\n      imagePositionPatient: (0, _getNumberValues2.default)(metaData['00200032'], 3),\n      sliceThickness: (0, _getNumberValue2.default)(metaData['00180050']),\n      sliceLocation: (0, _getNumberValue2.default)(metaData['00201041'])\n    };\n  }\n\n  if (type === 'imagePixelModule') {\n    return {\n      samplesPerPixel: (0, _getNumberValue2.default)(metaData['00280002']),\n      photometricInterpretation: (0, _getValue2.default)(metaData['00280004']),\n      rows: (0, _getNumberValue2.default)(metaData['00280010']),\n      columns: (0, _getNumberValue2.default)(metaData['00280011']),\n      bitsAllocated: (0, _getNumberValue2.default)(metaData['00280100']),\n      bitsStored: (0, _getNumberValue2.default)(metaData['00280101']),\n      highBit: (0, _getValue2.default)(metaData['00280102']),\n      pixelRepresentation: (0, _getNumberValue2.default)(metaData['00280103']),\n      planarConfiguration: (0, _getNumberValue2.default)(metaData['00280006']),\n      pixelAspectRatio: (0, _getValue2.default)(metaData['00280034']),\n      smallestPixelValue: (0, _getNumberValue2.default)(metaData['00280106']),\n      largestPixelValue: (0, _getNumberValue2.default)(metaData['00280107']),\n      redPaletteColorLookupTableDescriptor: (0, _getNumberValues2.default)(metaData['00281101']),\n      greenPaletteColorLookupTableDescriptor: (0, _getNumberValues2.default)(metaData['00281102']),\n      bluePaletteColorLookupTableDescriptor: (0, _getNumberValues2.default)(metaData['00281103']),\n      redPaletteColorLookupTableData: (0, _getNumberValues2.default)(metaData['00281201']),\n      greenPaletteColorLookupTableData: (0, _getNumberValues2.default)(metaData['00281202']),\n      bluePaletteColorLookupTableData: (0, _getNumberValues2.default)(metaData['00281203'])\n    };\n  }\n\n  if (type === 'voiLutModule') {\n    return {\n      // TODO VOT LUT Sequence\n      windowCenter: (0, _getNumberValues2.default)(metaData['00281050'], 1),\n      windowWidth: (0, _getNumberValues2.default)(metaData['00281051'], 1)\n    };\n  }\n\n  if (type === 'modalityLutModule') {\n    return {\n      // TODO VOT LUT Sequence\n      rescaleIntercept: (0, _getNumberValue2.default)(metaData['00281052']),\n      rescaleSlope: (0, _getNumberValue2.default)(metaData['00281053']),\n      rescaleType: (0, _getValue2.default)(metaData['00281054'])\n    };\n  }\n\n  if (type === 'sopCommonModule') {\n    return {\n      sopClassUID: (0, _getValue2.default)(metaData['00080016']),\n      sopInstanceUID: (0, _getValue2.default)(metaData['00080018'])\n    };\n  }\n\n  if (type === 'petIsotopeModule') {\n    var radiopharmaceuticalInfo = (0, _getValue2.default)(metaData['00540016']);\n\n    if (radiopharmaceuticalInfo === undefined) {\n      return;\n    }\n\n    return {\n      radiopharmaceuticalInfo: {\n        radiopharmaceuticalStartTime: _externalModules.dicomParser.parseTM((0, _getValue2.default)(radiopharmaceuticalInfo['00181072'], 0, '')),\n        radionuclideTotalDose: (0, _getNumberValue2.default)(radiopharmaceuticalInfo['00181074']),\n        radionuclideHalfLife: (0, _getNumberValue2.default)(radiopharmaceuticalInfo['00181075'])\n      }\n    };\n  }\n}\n\nexports.default = metaDataProvider;\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _externalModules = __webpack_require__(0);\n\nvar _options = __webpack_require__(6);\n\nfunction xhrRequest(url, imageId) {\n  var headers = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var params = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  var options = (0, _options.getOptions)();\n\n  // Make the request for the DICOM P10 SOP Instance\n  return new Promise(function (resolve, reject) {\n    var xhr = new XMLHttpRequest();\n\n    xhr.open('get', url, true);\n    xhr.responseType = 'arraybuffer';\n    options.beforeSend(xhr);\n    Object.keys(headers).forEach(function (key) {\n      xhr.setRequestHeader(key, headers[key]);\n    });\n\n    params.deferred = {\n      resolve: resolve,\n      reject: reject\n    };\n    params.url = url;\n    params.imageId = imageId;\n\n    // Event triggered when downloading an image starts\n    xhr.onloadstart = function (event) {\n      // Action\n      if (options.onloadstart) {\n        options.onloadstart(event, params);\n      }\n\n      // Event\n      var eventData = {\n        url: url,\n        imageId: imageId\n      };\n\n      (0, _externalModules.$)(_externalModules.external.cornerstone.events).trigger('CornerstoneImageLoadStart', eventData);\n\n      var customEvent = new CustomEvent('cornerstoneimageloadstart', { detail: eventData });\n\n      _externalModules.external.cornerstone.events.dispatchEvent(customEvent);\n    };\n\n    // Event triggered when downloading an image ends\n    xhr.onloadend = function (event) {\n      // Action\n      if (options.onloadend) {\n        options.onloadend(event, params);\n      }\n\n      var eventData = {\n        url: url,\n        imageId: imageId\n      };\n\n      // Event\n      (0, _externalModules.$)(_externalModules.external.cornerstone.events).trigger('CornerstoneImageLoadEnd', eventData);\n\n      var customEvent = new CustomEvent('cornerstoneimageloadend', { detail: eventData });\n\n      _externalModules.external.cornerstone.events.dispatchEvent(customEvent);\n    };\n\n    // handle response data\n    xhr.onreadystatechange = function (event) {\n      // Action\n      if (options.onreadystatechange) {\n        options.onreadystatechange(event, params);\n\n        return;\n      }\n\n      // Default action\n      // TODO: consider sending out progress messages here as we receive the pixel data\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          resolve(xhr.response, xhr);\n        } else {\n          // request failed, reject the Promise\n          reject(xhr);\n        }\n      }\n    };\n\n    // Event triggered when downloading an image progresses\n    xhr.onprogress = function (oProgress) {\n      // console.log('progress:',oProgress)\n      var loaded = oProgress.loaded; // evt.loaded the bytes browser receive\n      var total = void 0;\n      var percentComplete = void 0;\n\n      if (oProgress.lengthComputable) {\n        total = oProgress.total; // evt.total the total bytes seted by the header\n        percentComplete = Math.round(loaded / total * 100);\n      }\n\n      // Action\n      if (options.onprogress) {\n        options.onprogress(oProgress, params);\n      }\n\n      // Event\n      var eventData = {\n        url: url,\n        imageId: imageId,\n        loaded: loaded,\n        total: total,\n        percentComplete: percentComplete\n      };\n\n      (0, _externalModules.$)(_externalModules.external.cornerstone.events).trigger('CornerstoneImageLoadProgress', eventData);\n\n      var customEvent = new CustomEvent('cornerstoneimageloadprogress', { detail: eventData });\n\n      _externalModules.external.cornerstone.events.dispatchEvent(customEvent);\n    };\n\n    xhr.send();\n  });\n}\n\nexports.default = xhrRequest;\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (cornerstone) {\n  // register wadors scheme and metadata provider\n  cornerstone.registerImageLoader('wadors', _loadImage2.default);\n  cornerstone.metaData.addProvider(_index.metaDataProvider);\n};\n\nvar _loadImage = __webpack_require__(23);\n\nvar _loadImage2 = _interopRequireDefault(_loadImage);\n\nvar _index = __webpack_require__(18);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getEncapsulatedImageFrame = __webpack_require__(32);\n\nvar _getEncapsulatedImageFrame2 = _interopRequireDefault(_getEncapsulatedImageFrame);\n\nvar _getUncompressedImageFrame = __webpack_require__(33);\n\nvar _getUncompressedImageFrame2 = _interopRequireDefault(_getUncompressedImageFrame);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getPixelData(dataSet) {\n  var frameIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  var pixelDataElement = dataSet.elements.x7fe00010;\n\n  if (pixelDataElement.encapsulatedPixelData) {\n    return (0, _getEncapsulatedImageFrame2.default)(dataSet, frameIndex);\n  }\n\n  return (0, _getUncompressedImageFrame2.default)(dataSet, frameIndex);\n}\n\nexports.default = getPixelData;\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (cornerstone) {\n  // register dicomweb and wadouri image loader prefixes\n  cornerstone.registerImageLoader('dicomweb', _loadImage.loadImage);\n  cornerstone.registerImageLoader('wadouri', _loadImage.loadImage);\n  cornerstone.registerImageLoader('dicomfile', _loadImage.loadImage);\n\n  // add wadouri metadata provider\n  cornerstone.metaData.addProvider(_index.metaDataProvider);\n};\n\nvar _loadImage = __webpack_require__(36);\n\nvar _index = __webpack_require__(12);\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _index = __webpack_require__(1);\n\nfunction configure(options) {\n  (0, _index.setOptions)(options);\n}\n\nexports.default = configure;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// cornerstoneWADOImageLoader.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 39);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 19c1f85d7669329a8d0d","import $ from 'jquery';\nimport * as dicomParser from 'dicom-parser';\nimport registerLoaders from './imageLoader/registerLoaders.js';\n\nlet cornerstone;\n\nconst external = {\n  set cornerstone (cs) {\n    cornerstone = cs;\n\n    registerLoaders(cornerstone);\n  },\n  get cornerstone () {\n    return cornerstone;\n  }\n};\n\nexport { $, dicomParser, external };\n\n\n\n// WEBPACK FOOTER //\n// ./externalModules.js","import { default as xhrRequest } from './xhrRequest.js';\nimport { setOptions, getOptions } from './options.js';\n\nconst internal = {\n  xhrRequest,\n  setOptions,\n  getOptions\n};\n\nexport { setOptions, getOptions, xhrRequest, internal };\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/index.js","function getMinMax (storedPixelData) {\n  // we always calculate the min max values since they are not always\n  // present in DICOM and we don't want to trust them anyway as cornerstone\n  // depends on us providing reliable values for these\n  let min = storedPixelData[0];\n  let max = storedPixelData[0];\n  let storedPixel;\n  const numPixels = storedPixelData.length;\n\n  for (let index = 1; index < numPixels; index++) {\n    storedPixel = storedPixelData[index];\n    min = Math.min(min, storedPixel);\n    max = Math.max(max, storedPixel);\n  }\n\n  return {\n    min,\n    max\n  };\n}\n\nexport default getMinMax;\n\n\n\n// WEBPACK FOOTER //\n// ./shared/getMinMax.js","\n\n/**\n * Returns the raw value\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param [index] - the index of the value in a multi-valued element, default is 0\n * @param [defaultValue] - The default value to return if the element does not exist\n * @returns {*}\n */\nfunction getValue (element, index, defaultValue) {\n  index = index || 0;\n  if (!element) {\n    return defaultValue;\n  }\n  // Value is not present if the attribute has a zero length value\n  if (!element.Value) {\n    return defaultValue;\n  }\n  // make sure we have the specified index\n  if (element.Value.length <= index) {\n    return defaultValue;\n  }\n\n  return element.Value[index];\n}\n\nexport default getValue;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getValue.js","function parseImageId (imageId) {\n  // build a url by parsing out the url scheme and frame index from the imageId\n  const firstColonIndex = imageId.indexOf(':');\n  let url = imageId.substring(firstColonIndex + 1);\n  const frameIndex = url.indexOf('frame=');\n  let frame;\n\n  if (frameIndex !== -1) {\n    const frameStr = url.substr(frameIndex + 6);\n\n    frame = parseInt(frameStr, 10);\n    url = url.substr(0, frameIndex - 1);\n  }\n\n  return {\n    scheme: imageId.substr(0, firstColonIndex),\n    url,\n    frame\n  };\n}\n\nexport default parseImageId;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/parseImageId.js","\n\nlet imageIds = [];\n\nfunction add (imageId, metadata) {\n  imageIds[imageId] = metadata;\n}\n\nfunction get (imageId) {\n  return imageIds[imageId];\n}\n\nfunction remove (imageId) {\n  imageIds[imageId] = undefined;\n}\n\nfunction purge () {\n  imageIds = [];\n}\n\nexport default {\n  add,\n  get,\n  remove,\n  purge\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaDataManager.js","let options = {\n  // callback allowing customization of the xhr (e.g. adding custom auth headers, cors, etc)\n  beforeSend (/* xhr */) {\n  },\n  // callback allowing modification of newly created image objects\n  imageCreated (/* image */) {\n  },\n  strict: false\n};\n\nexport function setOptions (newOptions) {\n  options = newOptions;\n}\n\nexport function getOptions () {\n  return options;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/options.js","import { external } from '../externalModules.js';\nimport getImageFrame from './getImageFrame.js';\nimport decodeImageFrame from './decodeImageFrame.js';\nimport isColorImageFn from './isColorImage.js';\nimport convertColorSpace from './convertColorSpace.js';\nimport getMinMax from '../shared/getMinMax.js';\nimport isJPEGBaseline8BitColor from './isJPEGBaseline8BitColor.js';\n\nlet lastImageIdDrawn = '';\n\nfunction isModalityLUTForDisplay (sopClassUid) {\n  // special case for XA and XRF\n  // https://groups.google.com/forum/#!searchin/comp.protocols.dicom/Modality$20LUT$20XA/comp.protocols.dicom/UBxhOZ2anJ0/D0R_QP8V2wIJ\n  return sopClassUid !== '1.2.840.10008.5.1.4.1.1.12.1' && // XA\n         sopClassUid !== '1.2.840.10008.5.1.4.1.1.12.2.1'; // XRF\n}\n\n/**\n * Helper function to set pixel data to the right typed array.  This is needed because web workers\n * can transfer array buffers but not typed arrays\n * @param imageFrame\n */\nfunction setPixelDataType (imageFrame) {\n  if (imageFrame.bitsAllocated === 16) {\n    if (imageFrame.pixelRepresentation === 0) {\n      imageFrame.pixelData = new Uint16Array(imageFrame.pixelData);\n    } else {\n      imageFrame.pixelData = new Int16Array(imageFrame.pixelData);\n    }\n  } else {\n    imageFrame.pixelData = new Uint8Array(imageFrame.pixelData);\n  }\n}\n\nfunction createImage (imageId, pixelData, transferSyntax, options) {\n  const cornerstone = external.cornerstone;\n  const canvas = document.createElement('canvas');\n  const imageFrame = getImageFrame(imageId);\n  const decodePromise = decodeImageFrame(imageFrame, transferSyntax, pixelData, canvas, options);\n\n  return new Promise((resolve, reject) => {\n    decodePromise.then(function (imageFrame) {\n      const imagePlaneModule = cornerstone.metaData.get('imagePlaneModule', imageId) || {};\n      const voiLutModule = cornerstone.metaData.get('voiLutModule', imageId) || {};\n      const modalityLutModule = cornerstone.metaData.get('modalityLutModule', imageId) || {};\n      const sopCommonModule = cornerstone.metaData.get('sopCommonModule', imageId) || {};\n      const isColorImage = isColorImageFn(imageFrame.photometricInterpretation);\n\n      // JPEGBaseline (8 bits) is already returning the pixel data in the right format (rgba)\n      // because it's using a canvas to load and decode images.\n      if (!isJPEGBaseline8BitColor(imageFrame, transferSyntax)) {\n        setPixelDataType(imageFrame);\n\n        // convert color space\n        if (isColorImage) {\n          // setup the canvas context\n          canvas.height = imageFrame.rows;\n          canvas.width = imageFrame.columns;\n\n          const context = canvas.getContext('2d');\n          const imageData = context.createImageData(imageFrame.columns, imageFrame.rows);\n\n          convertColorSpace(imageFrame, imageData);\n          imageFrame.imageData = imageData;\n          imageFrame.pixelData = imageData.data;\n\n          // calculate smallest and largest PixelValue of the converted pixelData\n          const minMax = getMinMax(imageFrame.pixelData);\n\n          imageFrame.smallestPixelValue = minMax.min;\n          imageFrame.largestPixelValue = minMax.max;\n        }\n      }\n\n      const image = {\n        imageId,\n        color: isColorImage,\n        columnPixelSpacing: imagePlaneModule.pixelSpacing ? imagePlaneModule.pixelSpacing[1] : undefined,\n        columns: imageFrame.columns,\n        height: imageFrame.rows,\n        intercept: modalityLutModule.rescaleIntercept ? modalityLutModule.rescaleIntercept : 0,\n        invert: imageFrame.photometricInterpretation === 'MONOCHROME1',\n        minPixelValue: imageFrame.smallestPixelValue,\n        maxPixelValue: imageFrame.largestPixelValue,\n        render: undefined, // set below\n        rowPixelSpacing: imagePlaneModule.pixelSpacing ? imagePlaneModule.pixelSpacing[0] : undefined,\n        rows: imageFrame.rows,\n        sizeInBytes: imageFrame.pixelData.length,\n        slope: modalityLutModule.rescaleSlope ? modalityLutModule.rescaleSlope : 1,\n        width: imageFrame.columns,\n        windowCenter: voiLutModule.windowCenter ? voiLutModule.windowCenter[0] : undefined,\n        windowWidth: voiLutModule.windowWidth ? voiLutModule.windowWidth[0] : undefined,\n        decodeTimeInMS: imageFrame.decodeTimeInMS\n      };\n\n      // add function to return pixel data\n      image.getPixelData = () => imageFrame.pixelData;\n\n      // Setup the renderer\n      if (image.color) {\n        image.render = cornerstone.renderColorImage;\n        image.getCanvas = function () {\n          if (lastImageIdDrawn === imageId) {\n            return canvas;\n          }\n\n          canvas.height = image.rows;\n          canvas.width = image.columns;\n          const context = canvas.getContext('2d');\n\n          context.putImageData(imageFrame.imageData, 0, 0);\n          lastImageIdDrawn = imageId;\n\n          return canvas;\n        };\n\n      } else {\n        image.render = cornerstone.renderGrayscaleImage;\n      }\n\n      // Modality LUT\n      if (modalityLutModule.modalityLUTSequence &&\n        modalityLutModule.modalityLUTSequence.length > 0 &&\n        isModalityLUTForDisplay(sopCommonModule.sopClassUID)) {\n        image.modalityLUT = modalityLutModule.modalityLUTSequence[0];\n      }\n\n      // VOI LUT\n      if (voiLutModule.voiLUTSequence &&\n        voiLutModule.voiLUTSequence.length > 0) {\n        image.voiLUT = voiLutModule.voiLUTSequence[0];\n      }\n\n      // set the ww/wc to cover the dynamic range of the image if no values are supplied\n      if (image.windowCenter === undefined || image.windowWidth === undefined) {\n        if (image.color) {\n          image.windowWidth = 255;\n          image.windowCenter = 128;\n        } else {\n          const maxVoi = image.maxPixelValue * image.slope + image.intercept;\n          const minVoi = image.minPixelValue * image.slope + image.intercept;\n\n          image.windowWidth = maxVoi - minVoi;\n          image.windowCenter = (maxVoi + minVoi) / 2;\n        }\n      }\n      resolve(image);\n    }, reject);\n  });\n}\n\nexport default createImage;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/createImage.js","import { dicomParser } from '../../externalModules.js';\nimport { xhrRequest } from '../internal/index.js';\n\n/**\n * This object supports loading of DICOM P10 dataset from a uri and caching it so it can be accessed\n * by the caller.  This allows a caller to access the datasets without having to go through cornerstone's\n * image loader mechanism.  One reason a caller may need to do this is to determine the number of frames\n * in a multiframe sop instance so it can create the imageId's correctly.\n */\nlet loadedDataSets = {};\nlet promises = {};\n\n// returns true if the wadouri for the specified index has been loaded\nfunction isLoaded (uri) {\n  return loadedDataSets[uri] !== undefined;\n}\n\nfunction get (uri) {\n  if (!loadedDataSets[uri]) {\n    return;\n  }\n\n  return loadedDataSets[uri].dataSet;\n}\n\n\n// loads the dicom dataset from the wadouri sp\nfunction load (uri, loadRequest = xhrRequest, imageId) {\n  // if already loaded return it right away\n  if (loadedDataSets[uri]) {\n    // console.log('using loaded dataset ' + uri);\n    return new Promise((resolve) => {\n      loadedDataSets[uri].cacheCount++;\n      resolve(loadedDataSets[uri].dataSet);\n    });\n  }\n\n  // if we are currently loading this uri, return its promise\n  if (promises[uri]) {\n    // console.log('returning existing load promise for ' + uri);\n    return promises[uri];\n  }\n\n  // This uri is not loaded or being loaded, load it via an xhrRequest\n  const loadDICOMPromise = loadRequest(uri, imageId);\n\n  // handle success and failure of the XHR request load\n  const promise = new Promise((resolve, reject) => {\n    loadDICOMPromise.then(function (dicomPart10AsArrayBuffer/* , xhr*/) {\n      const byteArray = new Uint8Array(dicomPart10AsArrayBuffer);\n\n      // Reject the promise if parsing the dicom file fails\n      let dataSet;\n\n      try {\n        dataSet = dicomParser.parseDicom(byteArray);\n      } catch (error) {\n        return reject(error);\n      }\n\n      loadedDataSets[uri] = {\n        dataSet,\n        cacheCount: 1\n      };\n\n      resolve(dataSet);\n    }, reject).then(() => {\n      // Remove the promise regardless of success or failure\n      delete promises[uri];\n    });\n  });\n\n  promises[uri] = promise;\n\n  return promise;\n}\n\n// remove the cached/loaded dicom dataset for the specified wadouri to free up memory\nfunction unload (uri) {\n  // console.log('unload for ' + uri);\n  if (loadedDataSets[uri]) {\n    loadedDataSets[uri].cacheCount--;\n    if (loadedDataSets[uri].cacheCount === 0) {\n      // console.log('removing loaded dataset for ' + uri);\n      delete loadedDataSets[uri];\n    }\n  }\n}\n\n// removes all cached datasets from memory\nfunction purge () {\n  loadedDataSets = {};\n  promises = {};\n}\n\nexport default {\n  isLoaded,\n  load,\n  unload,\n  purge,\n  get\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/dataSetCacheManager.js","export default '1.0.1';\n\n\n\n// WEBPACK FOOTER //\n// ./version.js","export { default as convertRGBColorByPixel } from './convertRGBColorByPixel.js';\nexport { default as convertRGBColorByPlane } from './convertRGBColorByPlane.js';\nexport { default as convertYBRFullByPixel } from './convertYBRFullByPixel.js';\nexport { default as convertYBRFullByPlane } from './convertYBRFullByPlane.js';\nexport { default as convertPALETTECOLOR } from './convertPALETTECOLOR.js';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/index.js","import { getImagePixelModule,\n  getLUTs,\n  getModalityLUTOutputPixelRepresentation,\n  getNumberValues,\n  metaDataProvider } from './metaData/index.js';\n\nimport dataSetCacheManager from './dataSetCacheManager.js';\nimport fileManager from './fileManager.js';\nimport getEncapsulatedImageFrame from './getEncapsulatedImageFrame.js';\nimport getUncompressedImageFrame from './getUncompressedImageFrame.js';\nimport loadFileRequest from './loadFileRequest.js';\nimport { loadImageFromPromise,\n  getLoaderForScheme,\n  loadImage } from './loadImage.js';\nimport parseImageId from './parseImageId.js';\nimport unpackBinaryFrame from './unpackBinaryFrame.js';\nimport register from './register.js';\n\nconst metaData = {\n  getImagePixelModule,\n  getLUTs,\n  getModalityLUTOutputPixelRepresentation,\n  getNumberValues,\n  metaDataProvider\n};\n\nexport default {\n  metaData,\n  dataSetCacheManager,\n  fileManager,\n  getEncapsulatedImageFrame,\n  getUncompressedImageFrame,\n  loadFileRequest,\n  loadImageFromPromise,\n  getLoaderForScheme,\n  loadImage,\n  parseImageId,\n  unpackBinaryFrame,\n  register\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/index.js","export { default as getImagePixelModule } from './getImagePixelModule.js';\nexport { default as getLUTs } from './getLUTs.js';\nexport { default as getModalityLUTOutputPixelRepresentation } from './getModalityLUTOutputPixelRepresentation.js';\nexport { default as getNumberValues } from './getNumberValues.js';\nexport { default as metaDataProvider } from './metaDataProvider.js';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/index.js","function getLutDescriptor (dataSet, tag) {\n  if (!dataSet.elements[tag] || dataSet.elements[tag].length !== 6) {\n    return;\n  }\n\n  return [dataSet.uint16(tag, 0), dataSet.uint16(tag, 1), dataSet.uint16(tag, 2)];\n}\n\nfunction getLutData (lutDataSet, tag, lutDescriptor) {\n  const lut = [];\n  const lutData = lutDataSet.elements[tag];\n\n  // The first Palette Color Lookup Table Descriptor value is the number of entries in the lookup table.\n  // When the number of table entries is equal to 2ˆ16 then this value shall be 0.\n  // See http://dicom.nema.org/MEDICAL/DICOM/current/output/chtml/part03/sect_C.7.6.3.html#sect_C.7.6.3.1.5\n  const numLutEntries = lutDescriptor[0] || 65536;\n\n  for (let i = 0; i < numLutEntries; i++) {\n    // Output range is always unsigned\n    if (lutDescriptor[2] === 16) {\n      lut[i] = lutDataSet.uint16(tag, i);\n    } else {\n      lut[i] = lutDataSet.byteArray[i + lutData.dataOffset];\n    }\n  }\n\n  return lut;\n}\n\nfunction populatePaletteColorLut (dataSet, imagePixelModule) {\n  // return immediately if photometric interpretation is not PALETTE COLOR or no palette lut elements\n  if (imagePixelModule.photometricInterpretation !== 'PALETTE COLOR' || !dataSet.elements.x00281101) {\n    return;\n  }\n  imagePixelModule.redPaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281101');\n  imagePixelModule.greenPaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281102');\n  imagePixelModule.bluePaletteColorLookupTableDescriptor = getLutDescriptor(dataSet, 'x00281103');\n\n  imagePixelModule.redPaletteColorLookupTableData = getLutData(dataSet, 'x00281201', imagePixelModule.redPaletteColorLookupTableDescriptor);\n  imagePixelModule.greenPaletteColorLookupTableData = getLutData(dataSet, 'x00281202', imagePixelModule.greenPaletteColorLookupTableDescriptor);\n  imagePixelModule.bluePaletteColorLookupTableData = getLutData(dataSet, 'x00281203', imagePixelModule.bluePaletteColorLookupTableDescriptor);\n}\n\nfunction populateSmallestLargestPixelValues (dataSet, imagePixelModule) {\n  const pixelRepresentation = dataSet.uint16('x00280103');\n\n  if (pixelRepresentation === 0) {\n    imagePixelModule.smallestPixelValue = dataSet.uint16('x00280106');\n    imagePixelModule.largestPixelValue = dataSet.uint16('x00280107');\n  } else {\n    imagePixelModule.smallestPixelValue = dataSet.int16('x00280106');\n    imagePixelModule.largestPixelValue = dataSet.int16('x00280107');\n  }\n}\n\nfunction getImagePixelModule (dataSet) {\n  const imagePixelModule = {\n    samplesPerPixel: dataSet.uint16('x00280002'),\n    photometricInterpretation: dataSet.string('x00280004'),\n    rows: dataSet.uint16('x00280010'),\n    columns: dataSet.uint16('x00280011'),\n    bitsAllocated: dataSet.uint16('x00280100'),\n    bitsStored: dataSet.uint16('x00280101'),\n    highBit: dataSet.uint16('x00280102'),\n    pixelRepresentation: dataSet.uint16('x00280103'),\n    planarConfiguration: dataSet.uint16('x00280006'),\n    pixelAspectRatio: dataSet.string('x00280034')\n  };\n\n  populateSmallestLargestPixelValues(dataSet, imagePixelModule);\n  populatePaletteColorLut(dataSet, imagePixelModule);\n\n  return imagePixelModule;\n}\n\nexport default getImagePixelModule;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getImagePixelModule.js","function getLUT (pixelRepresentation, lutDataSet) {\n  let numLUTEntries = lutDataSet.uint16('x00283002', 0);\n\n  if (numLUTEntries === 0) {\n    numLUTEntries = 65535;\n  }\n  let firstValueMapped = 0;\n\n  if (pixelRepresentation === 0) {\n    firstValueMapped = lutDataSet.uint16('x00283002', 1);\n  } else {\n    firstValueMapped = lutDataSet.int16('x00283002', 1);\n  }\n  const numBitsPerEntry = lutDataSet.uint16('x00283002', 2);\n  // console.log('LUT(', numLUTEntries, ',', firstValueMapped, ',', numBitsPerEntry, ')');\n  const lut = {\n    id: '1',\n    firstValueMapped,\n    numBitsPerEntry,\n    lut: []\n  };\n\n  // console.log(\"minValue=\", minValue, \"; maxValue=\", maxValue);\n  for (let i = 0; i < numLUTEntries; i++) {\n    if (pixelRepresentation === 0) {\n      lut.lut[i] = lutDataSet.uint16('x00283006', i);\n    } else {\n      lut.lut[i] = lutDataSet.int16('x00283006', i);\n    }\n  }\n\n  return lut;\n}\n\n\nfunction getLUTs (pixelRepresentation, lutSequence) {\n  if (!lutSequence || !lutSequence.items.length) {\n    return;\n  }\n  const luts = [];\n\n  for (let i = 0; i < lutSequence.items.length; i++) {\n    const lutDataSet = lutSequence.items[i].dataSet;\n    const lut = getLUT(pixelRepresentation, lutDataSet);\n\n    if (lut) {\n      luts.push(lut);\n    }\n  }\n\n  return luts;\n}\n\nexport default getLUTs;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getLUTs.js","/* eslint no-bitwise: 0 */\n\nfunction getMinStoredPixelValue (dataSet) {\n  const pixelRepresentation = dataSet.uint16('x00280103');\n  const bitsStored = dataSet.uint16('x00280101');\n\n  if (pixelRepresentation === 0) {\n    return 0;\n  }\n\n  return -1 << (bitsStored - 1);\n}\n\n// 0 = unsigned / US, 1 = signed / SS\nfunction getModalityLUTOutputPixelRepresentation (dataSet) {\n\n  // CT SOP Classes are always signed\n  const sopClassUID = dataSet.string('x00080016');\n\n  if (sopClassUID === '1.2.840.10008.5.1.4.1.1.2' ||\n    sopClassUID === '1.2.840.10008.5.1.4.1.1.2.1') {\n    return 1;\n  }\n\n  // if rescale intercept and rescale slope are present, pass the minimum stored\n  // pixel value through them to see if we get a signed output range\n  const rescaleIntercept = dataSet.floatString('x00281052');\n  const rescaleSlope = dataSet.floatString('x00281053');\n\n  if (rescaleIntercept !== undefined && rescaleSlope !== undefined) {\n    const minStoredPixelValue = getMinStoredPixelValue(dataSet); //\n    const minModalityLutValue = minStoredPixelValue * rescaleSlope + rescaleIntercept;\n\n    if (minModalityLutValue < 0) {\n      return 1;\n    }\n\n    return 0;\n\n  }\n\n  // Output of non linear modality lut is always unsigned\n  if (dataSet.elements.x00283000 && dataSet.elements.x00283000.length > 0) {\n    return 0;\n  }\n\n  // If no modality lut transform, output is same as pixel representation\n  return dataSet.uint16('x00280103');\n}\n\nexport default getModalityLUTOutputPixelRepresentation;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js","function getNumberValues (dataSet, tag, minimumLength) {\n  const values = [];\n  const valueAsString = dataSet.string(tag);\n\n  if (!valueAsString) {\n    return;\n  }\n  const split = valueAsString.split('\\\\');\n\n  if (minimumLength && split.length < minimumLength) {\n    return;\n  }\n  for (let i = 0; i < split.length; i++) {\n    values.push(parseFloat(split[i]));\n  }\n\n  return values;\n}\n\nexport default getNumberValues;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/getNumberValues.js","import { getNumberString,\n  getNumberValue,\n  getNumberValues,\n  getValue,\n  metaDataProvider } from './metaData/index.js';\n\nimport findIndexOfString from './findIndexOfString.js';\nimport getPixelData from './getPixelData.js';\nimport metaDataManager from './metaDataManager.js';\nimport loadImage from './loadImage.js';\nimport register from './register.js';\n\nconst metaData = {\n  getNumberString,\n  getNumberValue,\n  getNumberValues,\n  getValue,\n  metaDataProvider\n};\n\nexport default {\n  metaData,\n  findIndexOfString,\n  getPixelData,\n  loadImage,\n  metaDataManager,\n  register\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/index.js","export { default as getNumberString } from './getNumberString.js';\nexport { default as getNumberValue } from './getNumberValue.js';\nexport { default as getNumberValues } from './getNumberValues.js';\nexport { default as getValue } from './getValue.js';\nexport { default as metaDataProvider } from './metaDataProvider.js';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/index.js","import getValue from './getValue.js';\n\nfunction getNumberValue (element, index) {\n  const value = getValue(element, index);\n\n  if (value === undefined) {\n    return;\n  }\n\n  return parseFloat(value);\n}\n\nexport default getNumberValue;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberValue.js","\n\n/**\n * Returns the values as an array of javascript numbers\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param [minimumLength] - the minimum number of values\n * @returns {*}\n */\nfunction getNumberValues (element, minimumLength) {\n  if (!element) {\n    return;\n  }\n  // Value is not present if the attribute has a zero length value\n  if (!element.Value) {\n    return;\n  }\n  // make sure we have the expected length\n  if (minimumLength && element.Value.length < minimumLength) {\n    return;\n  }\n\n  const values = [];\n\n  for (let i = 0; i < element.Value.length; i++) {\n    values.push(parseFloat(element.Value[i]));\n  }\n\n  return values;\n}\n\nexport default getNumberValues;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberValues.js","function checkToken (token, data, dataOffset) {\n\n  if (dataOffset + token.length > data.length) {\n    return false;\n  }\n\n  let endIndex = dataOffset;\n\n  for (let i = 0; i < token.length; i++) {\n    if (token[i] !== data[endIndex++]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction stringToUint8Array (str) {\n  const uint = new Uint8Array(str.length);\n\n  for (let i = 0, j = str.length; i < j; i++) {\n    uint[i] = str.charCodeAt(i);\n  }\n\n  return uint;\n}\n\nfunction findIndexOfString (data, str, offset) {\n\n  offset = offset || 0;\n\n  const token = stringToUint8Array(str);\n\n  for (let i = offset; i < data.length; i++) {\n    if (token[0] === data[i]) {\n      // console.log('match @', i);\n      if (checkToken(token, data, i)) {\n        return i;\n      }\n    }\n  }\n\n  return -1;\n}\nexport default findIndexOfString;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/findIndexOfString.js","import { xhrRequest } from '../internal/index.js';\nimport findIndexOfString from './findIndexOfString.js';\n\nfunction findBoundary (header) {\n  for (let i = 0; i < header.length; i++) {\n    if (header[i].substr(0, 2) === '--') {\n      return header[i];\n    }\n  }\n}\n\nfunction findContentType (header) {\n  for (let i = 0; i < header.length; i++) {\n    if (header[i].substr(0, 13) === 'Content-Type:') {\n      return header[i].substr(13).trim();\n    }\n  }\n}\n\nfunction uint8ArrayToString (data, offset, length) {\n  offset = offset || 0;\n  length = length || data.length - offset;\n  let str = '';\n\n  for (let i = offset; i < offset + length; i++) {\n    str += String.fromCharCode(data[i]);\n  }\n\n  return str;\n}\n\nfunction getPixelData (uri, imageId, mediaType = 'application/octet-stream') {\n  const headers = {\n    accept: mediaType\n  };\n\n  return new Promise((resolve, reject) => {\n    const loadPromise = xhrRequest(uri, imageId, headers);\n\n    loadPromise.then(function (imageFrameAsArrayBuffer/* , xhr*/) {\n\n      // request succeeded, Parse the multi-part mime response\n      const response = new Uint8Array(imageFrameAsArrayBuffer);\n\n      // First look for the multipart mime header\n      const tokenIndex = findIndexOfString(response, '\\r\\n\\r\\n');\n\n      if (tokenIndex === -1) {\n        reject(new Error('invalid response - no multipart mime header'));\n      }\n      const header = uint8ArrayToString(response, 0, tokenIndex);\n      // Now find the boundary  marker\n      const split = header.split('\\r\\n');\n      const boundary = findBoundary(split);\n\n      if (!boundary) {\n        reject(new Error('invalid response - no boundary marker'));\n      }\n      const offset = tokenIndex + 4; // skip over the \\r\\n\\r\\n\n\n      // find the terminal boundary marker\n      const endIndex = findIndexOfString(response, boundary, offset);\n\n      if (endIndex === -1) {\n        reject(new Error('invalid response - terminating boundary not found'));\n      }\n\n      // Remove \\r\\n from the length\n      const length = endIndex - offset - 2;\n\n      // return the info for this pixel data\n      resolve({\n        contentType: findContentType(split),\n        imageFrame: {\n          pixelData: new Uint8Array(imageFrameAsArrayBuffer, offset, length)\n        }\n      });\n    });\n  });\n}\n\nexport default getPixelData;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/getPixelData.js","import { $ } from '../../externalModules.js';\nimport metaDataManager from './metaDataManager.js';\nimport getPixelData from './getPixelData.js';\nimport createImage from '../createImage.js';\n\nfunction getTransferSyntaxForContentType (/* contentType */) {\n  return '1.2.840.10008.1.2'; // hard code to ILE for now\n}\n\nfunction loadImage (imageId, options) {\n  const start = new Date().getTime();\n  const uri = imageId.substring(7);\n\n  const deferred = $.Deferred();\n\n  // check to make sure we have metadata for this imageId\n  const metaData = metaDataManager.get(imageId);\n\n  if (metaData === undefined) {\n    deferred.reject(`no metadata for imageId ${imageId}`);\n\n    return deferred.promise();\n  }\n\n  // TODO: load bulk data items that we might need\n  const mediaType = 'multipart/related; type=\"application/octet-stream\"'; // 'image/dicom+jp2';\n\n  // get the pixel data from the server\n  getPixelData(uri, imageId, mediaType).then(function (result) {\n\n    const transferSyntax = getTransferSyntaxForContentType(result.contentType);\n    const pixelData = result.imageFrame.pixelData;\n    const imagePromise = createImage(imageId, pixelData, transferSyntax, options);\n\n    imagePromise.then(function (image) {\n      // add the loadTimeInMS property\n      const end = new Date().getTime();\n\n      image.loadTimeInMS = end - start;\n      deferred.resolve(image);\n    }, function (reason) {\n      deferred.reject(reason);\n    });\n  }, function (reason) {\n    deferred.reject(reason);\n  });\n\n  return deferred;\n}\n\nexport default loadImage;\n\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/loadImage.js","import { external } from '../externalModules.js';\n\nfunction getImageFrame (imageId) {\n  const imagePixelModule = external.cornerstone.metaData.get('imagePixelModule', imageId);\n\n  return {\n    samplesPerPixel: imagePixelModule.samplesPerPixel,\n    photometricInterpretation: imagePixelModule.photometricInterpretation,\n    planarConfiguration: imagePixelModule.planarConfiguration,\n    rows: imagePixelModule.rows,\n    columns: imagePixelModule.columns,\n    bitsAllocated: imagePixelModule.bitsAllocated,\n    pixelRepresentation: imagePixelModule.pixelRepresentation, // 0 = unsigned,\n    smallestPixelValue: imagePixelModule.smallestPixelValue,\n    largestPixelValue: imagePixelModule.largestPixelValue,\n    redPaletteColorLookupTableDescriptor: imagePixelModule.redPaletteColorLookupTableDescriptor,\n    greenPaletteColorLookupTableDescriptor: imagePixelModule.greenPaletteColorLookupTableDescriptor,\n    bluePaletteColorLookupTableDescriptor: imagePixelModule.bluePaletteColorLookupTableDescriptor,\n    redPaletteColorLookupTableData: imagePixelModule.redPaletteColorLookupTableData,\n    greenPaletteColorLookupTableData: imagePixelModule.greenPaletteColorLookupTableData,\n    bluePaletteColorLookupTableData: imagePixelModule.bluePaletteColorLookupTableData,\n    pixelData: undefined // populated later after decoding\n  };\n}\n\nexport default getImageFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/getImageFrame.js","import webWorkerManager from './webWorkerManager.js';\nimport decodeJPEGBaseline8BitColor from './decodeJPEGBaseline8BitColor.js';\n\nfunction addDecodeTask (imageFrame, transferSyntax, pixelData, options) {\n  const priority = options.priority || undefined;\n  const transferList = options.transferPixelData ? [pixelData.buffer] : undefined;\n\n  return webWorkerManager.addTask(\n    'decodeTask',\n    {\n      imageFrame,\n      transferSyntax,\n      pixelData,\n      options\n    }, priority, transferList).promise;\n}\n\nfunction decodeImageFrame (imageFrame, transferSyntax, pixelData, canvas, options = {}) {\n  // TODO: Turn this into a switch statement instead\n  if (transferSyntax === '1.2.840.10008.1.2') {\n    // Implicit VR Little Endian\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.1') {\n    // Explicit VR Little Endian\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.2') {\n    // Explicit VR Big Endian (retired)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.1.99') {\n    // Deflate transfer syntax (deflated by dicomParser)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.5') {\n    // RLE Lossless\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.50') {\n    // JPEG Baseline lossy process 1 (8 bit)\n\n    // Handle 8-bit JPEG Baseline color images using the browser's built-in\n    // JPEG decoding\n    if (imageFrame.bitsAllocated === 8 &&\n       (imageFrame.samplesPerPixel === 3 || imageFrame.samplesPerPixel === 4)) {\n      return decodeJPEGBaseline8BitColor(imageFrame, pixelData, canvas);\n    }\n\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.51') {\n    // JPEG Baseline lossy process 2 & 4 (12 bit)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.57') {\n    // JPEG Lossless, Nonhierarchical (Processes 14)\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.70') {\n    // JPEG Lossless, Nonhierarchical (Processes 14 [Selection 1])\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.80') {\n    // JPEG-LS Lossless Image Compression\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.81') {\n    // JPEG-LS Lossy (Near-Lossless) Image Compression\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.90') {\n    // JPEG 2000 Lossless\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  } else if (transferSyntax === '1.2.840.10008.1.2.4.91') {\n    // JPEG 2000 Lossy\n    return addDecodeTask(imageFrame, transferSyntax, pixelData, options);\n  }\n\n  /* Don't know if these work...\n   // JPEG 2000 Part 2 Multicomponent Image Compression (Lossless Only)\n   else if(transferSyntax === \"1.2.840.10008.1.2.4.92\")\n   {\n   return cornerstoneWADOImageLoader.decodeJPEG2000(dataSet, frame);\n   }\n   // JPEG 2000 Part 2 Multicomponent Image Compression\n   else if(transferSyntax === \"1.2.840.10008.1.2.4.93\")\n   {\n   return cornerstoneWADOImageLoader.decodeJPEG2000(dataSet, frame);\n   }\n   */\n\n  throw new Error(`No decoder for transfer syntax ${transferSyntax}`);\n}\n\nexport default decodeImageFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/decodeImageFrame.js","import { getOptions } from './internal/options.js';\n\n// the taskId to assign to the next task added via addTask()\nlet nextTaskId = 0;\n\n// array of queued tasks sorted with highest priority task first\nconst tasks = [];\n\n// array of web workers to dispatch decode tasks to\nconst webWorkers = [];\n\n// The options for CornerstoneWADOImageLoader\nconst options = getOptions();\n\nconst defaultConfig = {\n  maxWebWorkers: navigator.hardwareConcurrency || 1,\n  startWebWorkersOnDemand: true,\n  webWorkerPath: '../../dist/cornerstoneWADOImageLoaderWebWorker.js',\n  webWorkerTaskPaths: [],\n  taskConfiguration: {\n    decodeTask: {\n      loadCodecsOnStartup: true,\n      initializeCodecsOnStartup: false,\n      codecsPath: '../dist/cornerstoneWADOImageLoaderCodecs.js',\n      usePDFJS: false,\n      strict: options.strict\n    }\n  }\n};\n\nlet config;\n\nconst statistics = {\n  maxWebWorkers: 0,\n  numWebWorkers: 0,\n  numTasksQueued: 0,\n  numTasksExecuting: 0,\n  numTasksCompleted: 0,\n  totalTaskTimeInMS: 0,\n  totalTimeDelayedInMS: 0\n};\n\n/**\n * Function to start a task on a web worker\n */\nfunction startTaskOnWebWorker () {\n  // return immediately if no decode tasks to do\n  if (!tasks.length) {\n    return;\n  }\n\n  // look for a web worker that is ready\n  for (let i = 0; i < webWorkers.length; i++) {\n    if (webWorkers[i].status === 'ready') {\n      // mark it as busy so tasks are not assigned to it\n      webWorkers[i].status = 'busy';\n\n      // get the highest priority task\n      const task = tasks.shift();\n\n      task.start = new Date().getTime();\n\n      // update stats with how long this task was delayed (waiting in queue)\n      const end = new Date().getTime();\n\n      statistics.totalTimeDelayedInMS += end - task.added;\n\n      // assign this task to this web worker and send the web worker\n      // a message to execute it\n      webWorkers[i].task = task;\n      webWorkers[i].worker.postMessage({\n        taskType: task.taskType,\n        workerIndex: i,\n        data: task.data\n      }, task.transferList);\n      statistics.numTasksExecuting++;\n\n      return;\n    }\n  }\n\n  // if no available web workers and we haven't started max web workers, start a new one\n  if (webWorkers.length < config.maxWebWorkers) {\n    spawnWebWorker();\n  }\n}\n\n/**\n * Function to handle a message from a web worker\n * @param msg\n */\nfunction handleMessageFromWorker (msg) {\n  // console.log('handleMessageFromWorker', msg.data);\n  if (msg.data.taskType === 'initialize') {\n    webWorkers[msg.data.workerIndex].status = 'ready';\n    startTaskOnWebWorker();\n  } else {\n    const start = webWorkers[msg.data.workerIndex].task.start;\n\n    webWorkers[msg.data.workerIndex].task.deferred.resolve(msg.data.result);\n    webWorkers[msg.data.workerIndex].task = undefined;\n\n    statistics.numTasksExecuting--;\n    webWorkers[msg.data.workerIndex].status = 'ready';\n    statistics.numTasksCompleted++;\n\n    const end = new Date().getTime();\n\n    statistics.totalTaskTimeInMS += end - start;\n\n    startTaskOnWebWorker();\n  }\n}\n\n/**\n * Spawns a new web worker\n */\nfunction spawnWebWorker () {\n  // prevent exceeding maxWebWorkers\n  if (webWorkers.length >= config.maxWebWorkers) {\n    return;\n  }\n\n  // spawn the webworker\n  const worker = new Worker(config.webWorkerPath);\n\n  webWorkers.push({\n    worker,\n    status: 'initializing'\n  });\n  worker.addEventListener('message', handleMessageFromWorker);\n  worker.postMessage({\n    taskType: 'initialize',\n    workerIndex: webWorkers.length - 1,\n    config\n  });\n}\n\n/**\n * Initialization function for the web worker manager - spawns web workers\n * @param configObject\n */\nfunction initialize (configObject) {\n  configObject = configObject || defaultConfig;\n\n  // prevent being initialized more than once\n  if (config) {\n    throw new Error('WebWorkerManager already initialized');\n  }\n\n  config = configObject;\n\n  config.maxWebWorkers = config.maxWebWorkers || (navigator.hardwareConcurrency || 1);\n\n  // Spawn new web workers\n  if (!config.startWebWorkersOnDemand) {\n    for (let i = 0; i < config.maxWebWorkers; i++) {\n      spawnWebWorker();\n    }\n  }\n}\n\n/**\n * dynamically loads a web worker task\n * @param sourcePath\n * @param taskConfig\n */\nfunction loadWebWorkerTask (sourcePath, taskConfig) {\n  // add it to the list of web worker tasks paths so on demand web workers\n  // load this properly\n  config.webWorkerTaskPaths.push(sourcePath);\n\n  // if a task specific configuration is provided, merge it into the config\n  if (taskConfig) {\n    config.taskConfiguration = Object.assign(config.taskConfiguration, taskConfig);\n  }\n\n  // tell each spawned web worker to load this task\n  for (let i = 0; i < webWorkers.length; i++) {\n    webWorkers[i].worker.postMessage({\n      taskType: 'loadWebWorkerTask',\n      workerIndex: webWorkers.length - 1,\n      sourcePath,\n      config\n    });\n  }\n}\n\n/**\n * Function to add a decode task to be performed\n *\n * @param taskType - the taskType for this task\n * @param data - data specific to the task\n * @param priority - optional priority of the task (defaults to 0), > 0 is higher, < 0 is lower\n * @param transferList - optional array of data to transfer to web worker\n * @returns {*}\n */\nfunction addTask (taskType, data, priority = 0, transferList) {\n  if (!config) {\n    initialize();\n  }\n\n  let deferred = {};\n  const promise = new Promise((resolve, reject) => {\n    deferred = {\n      resolve,\n      reject\n    };\n  });\n\n  // find the right spot to insert this decode task (based on priority)\n  let i;\n\n  for (i = 0; i < tasks.length; i++) {\n    if (tasks[i].priority < priority) {\n      break;\n    }\n  }\n\n  const taskId = nextTaskId++;\n\n  // insert the decode task at position i\n  tasks.splice(i, 0, {\n    taskId,\n    taskType,\n    status: 'ready',\n    added: new Date().getTime(),\n    data,\n    deferred,\n    priority,\n    transferList\n  });\n\n  // try to start a task on the web worker since we just added a new task and a web worker may be available\n  startTaskOnWebWorker();\n\n  return {\n    taskId,\n    promise\n  };\n}\n\n/**\n * Changes the priority of a queued task\n * @param taskId - the taskId to change the priority of\n * @param priority - priority of the task (defaults to 0), > 0 is higher, < 0 is lower\n * @returns boolean - true on success, false if taskId not found\n */\nfunction setTaskPriority (taskId, priority = 0) {\n  // search for this taskId\n  for (let i = 0; i < tasks.length; i++) {\n    if (tasks[i].taskId === taskId) {\n      // taskId found, remove it\n      const task = tasks.splice(i, 1)[0];\n\n      // set its priority\n      task.priority = priority;\n\n      // find the right spot to insert this decode task (based on priority)\n      for (i = 0; i < tasks.length; i++) {\n        if (tasks[i].priority < priority) {\n          break;\n        }\n      }\n\n      // insert the decode task at position i\n      tasks.splice(i, 0, task);\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Cancels a queued task and rejects\n * @param taskId - the taskId to cancel\n * @param reason - optional reason the task was rejected\n * @returns boolean - true on success, false if taskId not found\n */\nfunction cancelTask (taskId, reason) {\n  // search for this taskId\n  for (let i = 0; i < tasks.length; i++) {\n    if (tasks[i].taskId === taskId) {\n      // taskId found, remove it\n      const task = tasks.splice(i, 1);\n\n      task.deferred.reject(reason);\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Function to return the statistics on running web workers\n * @returns object containing statistics\n */\nfunction getStatistics () {\n  statistics.maxWebWorkers = config.maxWebWorkers;\n  statistics.numWebWorkers = webWorkers.length;\n  statistics.numTasksQueued = tasks.length;\n\n  return statistics;\n}\n\nexport default {\n  initialize,\n  loadWebWorkerTask,\n  addTask,\n  getStatistics,\n  setTaskPriority,\n  cancelTask\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/webWorkerManager.js","import getMinMax from '../shared/getMinMax.js';\n\n/**\n * Special decoder for 8 bit jpeg that leverages the browser's built in JPEG decoder for increased performance\n */\n\nfunction arrayBufferToString (buffer) {\n  return binaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(new Uint8Array(buffer))));\n}\n\nfunction binaryToString (binary) {\n  let error;\n\n  try {\n    return decodeURIComponent(escape(binary));\n  } catch (_error) {\n    error = _error;\n    if (error instanceof URIError) {\n      return binary;\n    }\n    throw error;\n\n  }\n}\n\nfunction decodeJPEGBaseline8BitColor (imageFrame, pixelData, canvas) {\n  const start = new Date().getTime();\n  const imgBlob = new Blob([pixelData], { type: 'image/jpeg' });\n\n  return new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n\n    if (fileReader.readAsBinaryString === undefined) {\n      fileReader.readAsArrayBuffer(imgBlob);\n    } else {\n      fileReader.readAsBinaryString(imgBlob); // doesn't work on IE11\n    }\n\n    fileReader.onload = function () {\n      const img = new Image();\n\n      img.onload = function () {\n        canvas.height = img.height;\n        canvas.width = img.width;\n        imageFrame.rows = img.height;\n        imageFrame.columns = img.width;\n        const context = canvas.getContext('2d');\n\n        context.drawImage(this, 0, 0);\n        const imageData = context.getImageData(0, 0, img.width, img.height);\n        const end = new Date().getTime();\n\n        imageFrame.pixelData = imageData.data;\n        imageFrame.imageData = imageData;\n        imageFrame.decodeTimeInMS = end - start;\n\n        // calculate smallest and largest PixelValue\n        const minMax = getMinMax(imageFrame.pixelData);\n\n        imageFrame.smallestPixelValue = minMax.min;\n        imageFrame.largestPixelValue = minMax.max;\n\n        resolve(imageFrame);\n      };\n\n      img.onerror = function (error) {\n        reject(error);\n      };\n\n      if (fileReader.readAsBinaryString === undefined) {\n        img.src = `data:image/jpeg;base64,${window.btoa(arrayBufferToString(fileReader.result))}`;\n      } else {\n        img.src = `data:image/jpeg;base64,${window.btoa(fileReader.result)}`; // doesn't work on IE11\n      }\n    };\n\n    fileReader.onerror = (e) => {\n      reject(e);\n    };\n  });\n}\n\nexport default decodeJPEGBaseline8BitColor;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/decodeJPEGBaseline8BitColor.js","export default function (photoMetricInterpretation) {\n  return (photoMetricInterpretation === 'RGB' ||\n    photoMetricInterpretation === 'PALETTE COLOR' ||\n    photoMetricInterpretation === 'YBR_FULL' ||\n    photoMetricInterpretation === 'YBR_FULL_422' ||\n    photoMetricInterpretation === 'YBR_PARTIAL_422' ||\n    photoMetricInterpretation === 'YBR_PARTIAL_420' ||\n    photoMetricInterpretation === 'YBR_RCT' ||\n    photoMetricInterpretation === 'YBR_ICT');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/isColorImage.js","import { convertRGBColorByPixel, convertRGBColorByPlane,\n  convertYBRFullByPixel, convertYBRFullByPlane,\n  convertPALETTECOLOR } from './colorSpaceConverters/index.js';\n\nfunction convertRGB (imageFrame, rgbaBuffer) {\n  if (imageFrame.planarConfiguration === 0) {\n    convertRGBColorByPixel(imageFrame.pixelData, rgbaBuffer);\n  } else {\n    convertRGBColorByPlane(imageFrame.pixelData, rgbaBuffer);\n  }\n}\n\nfunction convertYBRFull (imageFrame, rgbaBuffer) {\n  if (imageFrame.planarConfiguration === 0) {\n    convertYBRFullByPixel(imageFrame.pixelData, rgbaBuffer);\n  } else {\n    convertYBRFullByPlane(imageFrame.pixelData, rgbaBuffer);\n  }\n}\n\nexport default function convertColorSpace (imageFrame, imageData) {\n  const rgbaBuffer = imageData.data;\n  // convert based on the photometric interpretation\n\n  if (imageFrame.photometricInterpretation === 'RGB') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'YBR_RCT') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'YBR_ICT') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'PALETTE COLOR') {\n    convertPALETTECOLOR(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'YBR_FULL_422') {\n    convertRGB(imageFrame, rgbaBuffer);\n  } else if (imageFrame.photometricInterpretation === 'YBR_FULL') {\n    convertYBRFull(imageFrame, rgbaBuffer);\n  } else {\n    throw new Error(`No color space conversion for photometric interpretation ${imageFrame.photometricInterpretation}`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/convertColorSpace.js","function isJPEGBaseline8BitColor (imageFrame, transferSyntax) {\n  transferSyntax = transferSyntax || imageFrame.transferSyntax;\n\n  if (imageFrame.bitsAllocated === 8 &&\n     transferSyntax === '1.2.840.10008.1.2.4.50' &&\n     (imageFrame.samplesPerPixel === 3 || imageFrame.samplesPerPixel === 4)) {\n    return true;\n  }\n}\n\nexport default isJPEGBaseline8BitColor;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/isJPEGBaseline8BitColor.js","let files = [];\n\nfunction add (file) {\n  const fileIndex = files.push(file);\n\n  return `dicomfile:${fileIndex - 1}`;\n}\n\nfunction get (index) {\n  return files[index];\n}\n\nfunction remove (index) {\n  files[index] = undefined;\n}\n\nfunction purge () {\n  files = [];\n}\n\nexport default {\n  add,\n  get,\n  remove,\n  purge\n};\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/fileManager.js","import { dicomParser } from '../../externalModules.js';\n\n/**\n * Function to deal with extracting an image frame from an encapsulated data set.\n */\n\n\nfunction framesAreFragmented (dataSet) {\n  const numberOfFrames = dataSet.intString('x00280008');\n  const pixelDataElement = dataSet.elements.x7fe00010;\n\n  return (numberOfFrames !== pixelDataElement.fragments.length);\n}\n\nexport default function getEncapsulatedImageFrame (dataSet, frameIndex) {\n  if (dataSet.elements.x7fe00010.basicOffsetTable.length) {\n    // Basic Offset Table is not empty\n    return dicomParser.readEncapsulatedImageFrame(dataSet, dataSet.elements.x7fe00010, frameIndex);\n  }\n\n  // Empty basic offset table\n\n  if (framesAreFragmented(dataSet)) {\n    const basicOffsetTable = dicomParser.createJPEGBasicOffsetTable(dataSet, dataSet.elements.x7fe00010);\n\n    return dicomParser.readEncapsulatedImageFrame(dataSet, dataSet.elements.x7fe00010, frameIndex, basicOffsetTable);\n  }\n\n  return dicomParser.readEncapsulatedPixelDataFromFragments(dataSet, dataSet.elements.x7fe00010, frameIndex);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/getEncapsulatedImageFrame.js","import unpackBinaryFrame from './unpackBinaryFrame.js';\n\n/**\n * Function to deal with extracting an image frame from an encapsulated data set.\n */\n\nfunction getUncompressedImageFrame (dataSet, frameIndex) {\n  const pixelDataElement = dataSet.elements.x7fe00010;\n  const bitsAllocated = dataSet.uint16('x00280100');\n  const rows = dataSet.uint16('x00280010');\n  const columns = dataSet.uint16('x00280011');\n  const samplesPerPixel = dataSet.uint16('x00280002');\n\n  const pixelDataOffset = pixelDataElement.dataOffset;\n  const pixelsPerFrame = rows * columns * samplesPerPixel;\n\n  let frameOffset;\n\n  if (bitsAllocated === 8) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return new Uint8Array(dataSet.byteArray.buffer, frameOffset, pixelsPerFrame);\n  } else if (bitsAllocated === 16) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame * 2;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return new Uint8Array(dataSet.byteArray.buffer, frameOffset, pixelsPerFrame * 2);\n  } else if (bitsAllocated === 1) {\n    frameOffset = pixelDataOffset + frameIndex * pixelsPerFrame * 0.125;\n    if (frameOffset >= dataSet.byteArray.length) {\n      throw new Error('frame exceeds size of pixelData');\n    }\n\n    return unpackBinaryFrame(dataSet.byteArray, frameOffset, pixelsPerFrame);\n  }\n\n  throw new Error('unsupported pixel format');\n}\n\nexport default getUncompressedImageFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/getUncompressedImageFrame.js","/* eslint no-bitwise: 0 */\n\nfunction isBitSet (byte, bitPos) {\n  return byte & (1 << bitPos);\n}\n\n/**\n * Function to deal with unpacking a binary frame\n */\nfunction unpackBinaryFrame (byteArray, frameOffset, pixelsPerFrame) {\n  // Create a new pixel array given the image size\n  const pixelData = new Uint8Array(pixelsPerFrame);\n\n  for (let i = 0; i < pixelsPerFrame; i++) {\n    // Compute byte position\n    const bytePos = Math.floor(i / 8);\n\n    // Get the current byte\n    const byte = byteArray[bytePos + frameOffset];\n\n    // Bit position (0-7) within byte\n    const bitPos = (i % 8);\n\n    // Check whether bit at bitpos is set\n    pixelData[i] = isBitSet(byte, bitPos) ? 1 : 0;\n  }\n\n  return pixelData;\n}\n\nexport default unpackBinaryFrame;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/unpackBinaryFrame.js","import parseImageId from './parseImageId.js';\nimport fileManager from './fileManager.js';\n\nfunction loadFileRequest (uri) {\n  const parsedImageId = parseImageId(uri);\n  const fileIndex = parseInt(parsedImageId.url, 10);\n  const file = fileManager.get(fileIndex);\n\n  return new Promise((resolve, reject) => {\n    const fileReader = new FileReader();\n\n    fileReader.onload = (e) => {\n      const dicomPart10AsArrayBuffer = e.target.result;\n\n      resolve(dicomPart10AsArrayBuffer);\n    };\n\n    fileReader.onerror = reject;\n\n    fileReader.readAsArrayBuffer(file);\n  });\n}\n\nexport default loadFileRequest;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/loadFileRequest.js","import { $ } from '../../externalModules.js';\nimport createImage from '../createImage.js';\nimport parseImageId from './parseImageId.js';\nimport dataSetCacheManager from './dataSetCacheManager.js';\nimport loadFileRequest from './loadFileRequest.js';\nimport getPixelData from './getPixelData.js';\nimport { xhrRequest } from '../internal/index.js';\n\n// add a decache callback function to clear out our dataSetCacheManager\nfunction addDecache (image) {\n  image.decache = function () {\n    // console.log('decache');\n    const parsedImageId = parseImageId(image.imageId);\n\n    dataSetCacheManager.unload(parsedImageId.url);\n  };\n}\n\nfunction loadImageFromPromise (dataSetPromise, imageId, frame = 0, sharedCacheKey, options) {\n  const start = new Date().getTime();\n  const deferred = $.Deferred();\n\n  dataSetPromise.then(function (dataSet/* , xhr*/) {\n    const pixelData = getPixelData(dataSet, frame);\n    const transferSyntax = dataSet.string('x00020010');\n    const loadEnd = new Date().getTime();\n    const imagePromise = createImage(imageId, pixelData, transferSyntax, options);\n\n    imagePromise.then(function (image) {\n      image.data = dataSet;\n      image.sharedCacheKey = sharedCacheKey;\n      const end = new Date().getTime();\n\n      image.loadTimeInMS = loadEnd - start;\n      image.totalTimeInMS = end - start;\n      addDecache(image);\n      deferred.resolve(image);\n    }, function (error) {\n      deferred.reject(error);\n    });\n  }, function (error) {\n    deferred.reject(error);\n  });\n\n  return deferred;\n}\n\nfunction loadImageFromDataSet (dataSet, imageId, frame = 0, sharedCacheKey, options) {\n  const start = new Date().getTime();\n  const deferred = $.Deferred();\n\n  const pixelData = getPixelData(dataSet, frame);\n  const transferSyntax = dataSet.string('x00020010');\n  const loadEnd = new Date().getTime();\n  const imagePromise = createImage(imageId, pixelData, transferSyntax, options);\n\n  imagePromise.then((image) => {\n    image.data = dataSet;\n    image.sharedCacheKey = sharedCacheKey;\n    const end = new Date().getTime();\n\n    image.loadTimeInMS = loadEnd - start;\n    image.totalTimeInMS = end - start;\n    addDecache(image);\n    deferred.resolve(image);\n  }, function (error) {\n    deferred.reject(error);\n  });\n\n  return deferred;\n}\n\nfunction getLoaderForScheme (scheme) {\n  if (scheme === 'dicomweb' || scheme === 'wadouri') {\n    return xhrRequest;\n  } else if (scheme === 'dicomfile') {\n    return loadFileRequest;\n  }\n}\n\nfunction loadImage (imageId, options) {\n  const parsedImageId = parseImageId(imageId);\n  const loader = getLoaderForScheme(parsedImageId.scheme);\n\n  // if the dataset for this url is already loaded, use it\n  if (dataSetCacheManager.isLoaded(parsedImageId.url)) {\n    const dataSet = dataSetCacheManager.get(parsedImageId.url, loader, imageId);\n\n    return loadImageFromDataSet(dataSet, imageId, parsedImageId.frame, parsedImageId.url, options);\n  }\n\n  // load the dataSet via the dataSetCacheManager\n  const dataSetPromise = dataSetCacheManager.load(parsedImageId.url, loader, imageId);\n\n  return loadImageFromPromise(dataSetPromise, imageId, parsedImageId.frame, parsedImageId.url, options);\n}\n\nexport { loadImageFromPromise, getLoaderForScheme, loadImage };\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/loadImage.js","export * from './colorSpaceConverters/index.js';\n\nexport { default as wadouri } from './wadouri/index.js';\nexport { default as wadors } from './wadors/index.js';\nexport { default as configure } from './configure.js';\nexport { default as convertColorSpace } from './convertColorSpace.js';\nexport { default as createImage } from './createImage.js';\nexport { default as decodeImageFrame } from './decodeImageFrame.js';\nexport { default as decodeJPEGBaseline8BitColor } from './decodeJPEGBaseline8BitColor.js';\nexport { default as getImageFrame } from './getImageFrame.js';\nexport { default as getMinMax } from '../shared/getMinMax.js';\nexport { default as isColorImage } from './isColorImage.js';\nexport { default as isJPEGBaseline8BitColor } from './isJPEGBaseline8BitColor.js';\nexport { default as webWorkerManager } from './webWorkerManager.js';\nexport { default as version } from '../version.js';\nexport { internal } from './internal/index.js';\nexport { external } from '../externalModules.js';\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/index.js","export default function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: rgbBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: rgbBuffer length must be divisible by 3');\n  }\n\n  const numPixels = imageFrame.length / 3;\n  let rgbIndex = 0;\n  let rgbaIndex = 0;\n\n  for (let i = 0; i < numPixels; i++) {\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // red\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // green\n    rgbaBuffer[rgbaIndex++] = imageFrame[rgbIndex++]; // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js","export default function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: rgbBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: rgbBuffer length must be divisible by 3');\n  }\n\n  const numPixels = imageFrame.length / 3;\n  let rgbaIndex = 0;\n  let rIndex = 0;\n  let gIndex = numPixels;\n  let bIndex = numPixels * 2;\n\n  for (let i = 0; i < numPixels; i++) {\n    rgbaBuffer[rgbaIndex++] = imageFrame[rIndex++]; // red\n    rgbaBuffer[rgbaIndex++] = imageFrame[gIndex++]; // green\n    rgbaBuffer[rgbaIndex++] = imageFrame[bIndex++]; // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js","export default function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: ybrBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: ybrBuffer length must be divisble by 3');\n  }\n\n  const numPixels = imageFrame.length / 3;\n  let ybrIndex = 0;\n  let rgbaIndex = 0;\n\n  for (let i = 0; i < numPixels; i++) {\n    const y = imageFrame[ybrIndex++];\n    const cb = imageFrame[ybrIndex++];\n    const cr = imageFrame[ybrIndex++];\n\n    rgbaBuffer[rgbaIndex++] = y + 1.40200 * (cr - 128);// red\n    rgbaBuffer[rgbaIndex++] = y - 0.34414 * (cb - 128) - 0.71414 * (cr - 128); // green\n    rgbaBuffer[rgbaIndex++] = y + 1.77200 * (cb - 128); // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js","export default function (imageFrame, rgbaBuffer) {\n  if (imageFrame === undefined) {\n    throw new Error('decodeRGB: ybrBuffer must not be undefined');\n  }\n  if (imageFrame.length % 3 !== 0) {\n    throw new Error('decodeRGB: ybrBuffer length must be divisble by 3');\n  }\n\n  const numPixels = imageFrame.length / 3;\n  let rgbaIndex = 0;\n  let yIndex = 0;\n  let cbIndex = numPixels;\n  let crIndex = numPixels * 2;\n\n  for (let i = 0; i < numPixels; i++) {\n    const y = imageFrame[yIndex++];\n    const cb = imageFrame[cbIndex++];\n    const cr = imageFrame[crIndex++];\n\n    rgbaBuffer[rgbaIndex++] = y + 1.40200 * (cr - 128);// red\n    rgbaBuffer[rgbaIndex++] = y - 0.34414 * (cb - 128) - 0.71414 * (cr - 128); // green\n    rgbaBuffer[rgbaIndex++] = y + 1.77200 * (cb - 128); // blue\n    rgbaBuffer[rgbaIndex++] = 255; // alpha\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js","/* eslint no-bitwise: 0 */\n\nexport default function (imageFrame, rgbaBuffer) {\n  const numPixels = imageFrame.columns * imageFrame.rows;\n  let palIndex = 0;\n  let rgbaIndex = 0;\n  const pixelData = imageFrame.pixelData;\n  const start = imageFrame.redPaletteColorLookupTableDescriptor[1];\n  const rData = imageFrame.redPaletteColorLookupTableData;\n  const gData = imageFrame.greenPaletteColorLookupTableData;\n  const bData = imageFrame.bluePaletteColorLookupTableData;\n  const shift = imageFrame.redPaletteColorLookupTableDescriptor[2] === 8 ? 0 : 8;\n  let len = imageFrame.redPaletteColorLookupTableData.length;\n\n  if (len === 0) {\n    len = 65535;\n  }\n\n  for (let i = 0; i < numPixels; ++i) {\n    let value = pixelData[palIndex++];\n\n    if (value < start) {\n      value = 0;\n    } else if (value > start + len - 1) {\n      value = len - 1;\n    } else {\n      value -= start;\n    }\n\n    rgbaBuffer[rgbaIndex++] = rData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = gData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = bData[value] >> shift;\n    rgbaBuffer[rgbaIndex++] = 255;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js","import { dicomParser } from '../../../externalModules.js';\nimport getNumberValues from './getNumberValues.js';\nimport parseImageId from '../parseImageId.js';\nimport dataSetCacheManager from '../dataSetCacheManager.js';\nimport getImagePixelModule from './getImagePixelModule.js';\nimport getLUTs from './getLUTs.js';\nimport getModalityLUTOutputPixelRepresentation from './getModalityLUTOutputPixelRepresentation.js';\n\nfunction metaDataProvider (type, imageId) {\n  const parsedImageId = parseImageId(imageId);\n\n  const dataSet = dataSetCacheManager.get(parsedImageId.url);\n\n  if (!dataSet) {\n    return;\n  }\n\n  if (type === 'generalSeriesModule') {\n    return {\n      modality: dataSet.string('x00080060'),\n      seriesInstanceUID: dataSet.string('x0020000e'),\n      seriesNumber: dataSet.intString('x00200011'),\n      studyInstanceUID: dataSet.string('x0020000d'),\n      seriesDate: dicomParser.parseDA(dataSet.string('x00080021')),\n      seriesTime: dicomParser.parseTM(dataSet.string('x00080031') || '')\n    };\n  }\n\n  if (type === 'patientStudyModule') {\n    return {\n      patientAge: dataSet.intString('x00101010'),\n      patientSize: dataSet.floatString('x00101020'),\n      patientWeight: dataSet.floatString('x00101030')\n    };\n  }\n\n  if (type === 'imagePlaneModule') {\n    return {\n      pixelSpacing: getNumberValues(dataSet, 'x00280030', 2),\n      imageOrientationPatient: getNumberValues(dataSet, 'x00200037', 6),\n      imagePositionPatient: getNumberValues(dataSet, 'x00200032', 3),\n      sliceThickness: dataSet.floatString('x00180050'),\n      sliceLocation: dataSet.floatString('x00201041'),\n      frameOfReferenceUID: dataSet.string('x00200052')\n    };\n  }\n\n  if (type === 'imagePixelModule') {\n    return getImagePixelModule(dataSet);\n  }\n\n  if (type === 'modalityLutModule') {\n    return {\n      rescaleIntercept: dataSet.floatString('x00281052'),\n      rescaleSlope: dataSet.floatString('x00281053'),\n      rescaleType: dataSet.string('x00281054'),\n      modalityLUTSequence: getLUTs(dataSet.uint16('x00280103'), dataSet.elements.x00283000)\n    };\n  }\n\n  if (type === 'voiLutModule') {\n    const modalityLUTOutputPixelRepresentation = getModalityLUTOutputPixelRepresentation(dataSet);\n\n\n    return {\n      windowCenter: getNumberValues(dataSet, 'x00281050', 1),\n      windowWidth: getNumberValues(dataSet, 'x00281051', 1),\n      voiLUTSequence: getLUTs(modalityLUTOutputPixelRepresentation, dataSet.elements.x00283010)\n    };\n  }\n\n  if (type === 'sopCommonModule') {\n    return {\n      sopClassUID: dataSet.string('x00080016'),\n      sopInstanceUID: dataSet.string('x00080018')\n    };\n  }\n\n  if (type === 'petIsotopeModule') {\n    const radiopharmaceuticalInfo = dataSet.elements.x00540016;\n\n    if (radiopharmaceuticalInfo === undefined) {\n      return;\n    }\n\n    const firstRadiopharmaceuticalInfoDataSet = radiopharmaceuticalInfo.items[0].dataSet;\n\n\n    return {\n      radiopharmaceuticalInfo: {\n        radiopharmaceuticalStartTime: dicomParser.parseTM(firstRadiopharmaceuticalInfoDataSet.string('x00181072') || ''),\n        radionuclideTotalDose: firstRadiopharmaceuticalInfoDataSet.floatString('x00181074'),\n        radionuclideHalfLife: firstRadiopharmaceuticalInfoDataSet.floatString('x00181075')\n      }\n    };\n  }\n}\n\nexport default metaDataProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/metaData/metaDataProvider.js","module.exports = __WEBPACK_EXTERNAL_MODULE_46__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}\n// module id = 46\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_47__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"dicom-parser\",\"commonjs2\":\"dicom-parser\",\"amd\":\"dicom-parser\",\"root\":\"dicomParser\"}\n// module id = 47\n// module chunks = 0","import wadors from './wadors/index.js';\nimport wadouri from './wadouri/index.js';\n\n/**\n * Register the WADO-URI and WADO-RS image loaders and metaData providers\n * with an instance of Cornerstone Core.\n *\n * @param cornerstone The Cornerstone Core library to register the image loaders with\n */\nfunction registerLoaders (cornerstone) {\n  wadors.register(cornerstone);\n  wadouri.register(cornerstone);\n}\n\nexport default registerLoaders;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/registerLoaders.js","import getValue from './getValue.js';\n\n/**\n * Returns the first string value as a Javascript number\n *\n * @param element - The javascript object for the specified element in the metadata\n * @param [index] - the index of the value in a multi-valued element, default is 0\n * @param [defaultValue] - The default value to return if the element does not exist\n * @returns {*}\n */\nfunction getNumberString (element, index, defaultValue) {\n  const value = getValue(element, index, defaultValue);\n\n  if (value === undefined) {\n    return;\n  }\n\n  return parseFloat(value);\n}\n\nexport default getNumberString;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/getNumberString.js","import { dicomParser } from '../../../externalModules.js';\nimport getNumberValues from './getNumberValues.js';\nimport getValue from './getValue.js';\nimport getNumberValue from './getNumberValue.js';\nimport metaDataManager from '../metaDataManager.js';\n\nfunction metaDataProvider (type, imageId) {\n  const metaData = metaDataManager.get(imageId);\n\n  if (!metaData) {\n    return;\n  }\n\n  if (type === 'generalSeriesModule') {\n    return {\n      modality: getValue(metaData['00080060']),\n      seriesInstanceUID: getValue(metaData['0020000e']),\n      seriesNumber: getNumberValue(metaData['00200011']),\n      studyInstanceUID: getValue(metaData['0020000d']),\n      seriesDate: dicomParser.parseDA(getValue(metaData['00080021'])),\n      seriesTime: dicomParser.parseTM(getValue(metaData['00080031'], 0, ''))\n    };\n  }\n\n  if (type === 'patientStudyModule') {\n    return {\n      patientAge: getNumberValue(metaData['00101010']),\n      patientSize: getNumberValue(metaData['00101020']),\n      patientWeight: getNumberValue(metaData['00101030'])\n    };\n  }\n\n  if (type === 'imagePlaneModule') {\n    return {\n      pixelSpacing: getNumberValues(metaData['00280030'], 2),\n      imageOrientationPatient: getNumberValues(metaData['00200037'], 6),\n      imagePositionPatient: getNumberValues(metaData['00200032'], 3),\n      sliceThickness: getNumberValue(metaData['00180050']),\n      sliceLocation: getNumberValue(metaData['00201041'])\n    };\n  }\n\n  if (type === 'imagePixelModule') {\n    return {\n      samplesPerPixel: getNumberValue(metaData['00280002']),\n      photometricInterpretation: getValue(metaData['00280004']),\n      rows: getNumberValue(metaData['00280010']),\n      columns: getNumberValue(metaData['00280011']),\n      bitsAllocated: getNumberValue(metaData['00280100']),\n      bitsStored: getNumberValue(metaData['00280101']),\n      highBit: getValue(metaData['00280102']),\n      pixelRepresentation: getNumberValue(metaData['00280103']),\n      planarConfiguration: getNumberValue(metaData['00280006']),\n      pixelAspectRatio: getValue(metaData['00280034']),\n      smallestPixelValue: getNumberValue(metaData['00280106']),\n      largestPixelValue: getNumberValue(metaData['00280107']),\n      redPaletteColorLookupTableDescriptor: getNumberValues(metaData['00281101']),\n      greenPaletteColorLookupTableDescriptor: getNumberValues(metaData['00281102']),\n      bluePaletteColorLookupTableDescriptor: getNumberValues(metaData['00281103']),\n      redPaletteColorLookupTableData: getNumberValues(metaData['00281201']),\n      greenPaletteColorLookupTableData: getNumberValues(metaData['00281202']),\n      bluePaletteColorLookupTableData: getNumberValues(metaData['00281203'])\n    };\n  }\n\n  if (type === 'voiLutModule') {\n    return {\n      // TODO VOT LUT Sequence\n      windowCenter: getNumberValues(metaData['00281050'], 1),\n      windowWidth: getNumberValues(metaData['00281051'], 1)\n    };\n  }\n\n  if (type === 'modalityLutModule') {\n    return {\n      // TODO VOT LUT Sequence\n      rescaleIntercept: getNumberValue(metaData['00281052']),\n      rescaleSlope: getNumberValue(metaData['00281053']),\n      rescaleType: getValue(metaData['00281054'])\n    };\n  }\n\n  if (type === 'sopCommonModule') {\n    return {\n      sopClassUID: getValue(metaData['00080016']),\n      sopInstanceUID: getValue(metaData['00080018'])\n    };\n  }\n\n  if (type === 'petIsotopeModule') {\n    const radiopharmaceuticalInfo = getValue(metaData['00540016']);\n\n    if (radiopharmaceuticalInfo === undefined) {\n      return;\n    }\n\n    return {\n      radiopharmaceuticalInfo: {\n        radiopharmaceuticalStartTime: dicomParser.parseTM(getValue(radiopharmaceuticalInfo['00181072'], 0, '')),\n        radionuclideTotalDose: getNumberValue(radiopharmaceuticalInfo['00181074']),\n        radionuclideHalfLife: getNumberValue(radiopharmaceuticalInfo['00181075'])\n      }\n    };\n  }\n\n}\n\nexport default metaDataProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/metaData/metaDataProvider.js","import { $, external } from '../../externalModules.js';\nimport { getOptions } from './options.js';\n\nfunction xhrRequest (url, imageId, headers = {}, params = {}) {\n  const options = getOptions();\n\n  // Make the request for the DICOM P10 SOP Instance\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n\n    xhr.open('get', url, true);\n    xhr.responseType = 'arraybuffer';\n    options.beforeSend(xhr);\n    Object.keys(headers).forEach(function (key) {\n      xhr.setRequestHeader(key, headers[key]);\n    });\n\n    params.deferred = {\n      resolve,\n      reject\n    };\n    params.url = url;\n    params.imageId = imageId;\n\n    // Event triggered when downloading an image starts\n    xhr.onloadstart = function (event) {\n      // Action\n      if (options.onloadstart) {\n        options.onloadstart(event, params);\n      }\n\n      // Event\n      const eventData = {\n        url,\n        imageId\n      };\n\n      $(external.cornerstone.events).trigger('CornerstoneImageLoadStart', eventData);\n\n      const customEvent = new CustomEvent('cornerstoneimageloadstart', { detail: eventData });\n\n      external.cornerstone.events.dispatchEvent(customEvent);\n    };\n\n    // Event triggered when downloading an image ends\n    xhr.onloadend = function (event) {\n      // Action\n      if (options.onloadend) {\n        options.onloadend(event, params);\n      }\n\n      const eventData = {\n        url,\n        imageId\n      };\n\n      // Event\n      $(external.cornerstone.events).trigger('CornerstoneImageLoadEnd', eventData);\n\n      const customEvent = new CustomEvent('cornerstoneimageloadend', { detail: eventData });\n\n      external.cornerstone.events.dispatchEvent(customEvent);\n    };\n\n    // handle response data\n    xhr.onreadystatechange = function (event) {\n      // Action\n      if (options.onreadystatechange) {\n        options.onreadystatechange(event, params);\n\n        return;\n      }\n\n      // Default action\n      // TODO: consider sending out progress messages here as we receive the pixel data\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          resolve(xhr.response, xhr);\n        } else {\n          // request failed, reject the Promise\n          reject(xhr);\n        }\n      }\n    };\n\n    // Event triggered when downloading an image progresses\n    xhr.onprogress = function (oProgress) {\n      // console.log('progress:',oProgress)\n      const loaded = oProgress.loaded; // evt.loaded the bytes browser receive\n      let total;\n      let percentComplete;\n\n      if (oProgress.lengthComputable) {\n        total = oProgress.total; // evt.total the total bytes seted by the header\n        percentComplete = Math.round((loaded / total) * 100);\n      }\n\n      // Action\n      if (options.onprogress) {\n        options.onprogress(oProgress, params);\n      }\n\n      // Event\n      const eventData = {\n        url,\n        imageId,\n        loaded,\n        total,\n        percentComplete\n      };\n\n      $(external.cornerstone.events).trigger('CornerstoneImageLoadProgress', eventData);\n\n      const customEvent = new CustomEvent('cornerstoneimageloadprogress', { detail: eventData });\n\n      external.cornerstone.events.dispatchEvent(customEvent);\n    };\n\n    xhr.send();\n  });\n}\n\nexport default xhrRequest;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/internal/xhrRequest.js","import loadImage from './loadImage';\nimport { metaDataProvider } from './metaData/index.js';\n\nexport default function (cornerstone) {\n  // register wadors scheme and metadata provider\n  cornerstone.registerImageLoader('wadors', loadImage);\n  cornerstone.metaData.addProvider(metaDataProvider);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadors/register.js","import getEncapsulatedImageFrame from './getEncapsulatedImageFrame.js';\nimport getUncompressedImageFrame from './getUncompressedImageFrame.js';\n\nfunction getPixelData (dataSet, frameIndex = 0) {\n  const pixelDataElement = dataSet.elements.x7fe00010;\n\n  if (pixelDataElement.encapsulatedPixelData) {\n    return getEncapsulatedImageFrame(dataSet, frameIndex);\n  }\n\n  return getUncompressedImageFrame(dataSet, frameIndex);\n}\n\nexport default getPixelData;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/getPixelData.js","import { loadImage } from './loadImage';\nimport { metaDataProvider } from './metaData/index.js';\n\nexport default function (cornerstone) {\n  // register dicomweb and wadouri image loader prefixes\n  cornerstone.registerImageLoader('dicomweb', loadImage);\n  cornerstone.registerImageLoader('wadouri', loadImage);\n  cornerstone.registerImageLoader('dicomfile', loadImage);\n\n  // add wadouri metadata provider\n  cornerstone.metaData.addProvider(metaDataProvider);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/wadouri/register.js","import { setOptions } from './internal/index.js';\n\nfunction configure (options) {\n  setOptions(options);\n}\n\nexport default configure;\n\n\n\n// WEBPACK FOOTER //\n// ./imageLoader/configure.js"],"sourceRoot":""}